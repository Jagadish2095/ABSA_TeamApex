/**
 * @description OnboardingMainUtilTest
 *
 * @author  Anka Ganta : Absa
 * @version v1.0
 * @since   2020-08-08
 */
@istest
public class OnboardingMainUtilTest {
    /**
    * @description testGetParticipantsData
    */
    @istest
    static void testGetParticipantsData(){
        Account account = new Account(Name = 'Test Account');
		account.RecordTypeId = schema.SObjectType.account.getRecordTypeInfosByName().get('Business Prospect').getRecordTypeId();
		
		account.Country_of_Incorporation__c = 'South Africa';
		account.Client_Group__c = 'Non Individual';
		account.CASA_Reference_Number__c = '12233';
		account.CASA_Screening_Status__c = 'Cancelled';
		account.CIF__c = '';
		account.Countries_Traded_With__c = 'South Africa';
		account.Source_of_Income__c = 'Donation';
        account.UBO_ParentAccountWrapper__c = '[{"Type":"Private Company","ShareholderCount":3,"Shareholder":"PASCAL SOLUTIONS (PTY) LTD","recordId":"0015r00000Ht2mtAAB","ParentShareholding":100,"Controllinginterest":100,"Accwrplist":[{"UBO":"","Type":"Private Company","ShareholderCount":2,"Shareholder":"GAMBULELA TRADING (PTY) LTD","roles":"Shareholder/Controller","relatedAccountId":"0015r00000EYE78AAH","recordId":"a005r000001u7LyAAI","primaryEntityId":"0015r00000Ht2mtAAB","ParentShareholding":25.00,"parentAccountId":"0015r00000Ht2mtAAB","idType":"Registration Number","Controllinginterest":25.00,"childwrplist":[{"UBO":"No","Type":"Individual","ShareholderCount":0,"Shareholder":"NTEMBEKO NTANTISO MAKALIMA","roles":"Director;Individual with Authority to Act;Shareholder/Controller;Contact Person;Operators on primary accounts ( Internet Main Users, Signatories, Card Users);Manager","relatedAccountId":"0035r00000C2V0PAAV","recordId":"07k5r000002QR7cAAG","primaryEntityId":"0015r00000EYE78AAH","ParentShareholding":10.00,"parentAccountId":"0015r00000EYE78AAH","idType":"SA Identity Document","Controllinginterest":2.50,"childwrplist":null,"accType":"AccountContact"},{"UBO":"","Type":"Trusts","ShareholderCount":2,"Shareholder":"Greyling Trust","roles":"Shareholder/Controller","relatedAccountId":"0015r00000EYC4QAAX","recordId":"a005r000001b3GJAAY","primaryEntityId":"0015r00000EYE78AAH","ParentShareholding":90.00,"parentAccountId":"0015r00000EYE78AAH","idType":"Non-Registered Entity","Controllinginterest":22.50,"childwrplist":[{"UBO":"Yes","Type":"Individual","ShareholderCount":0,"Shareholder":"GANAS SOOBRAMONY NAIDU","roles":"Named Beneficiaries","relatedAccountId":"0035r00000C1GWKAA3","recordId":"07k5r000002QQTtAAO","primaryEntityId":"0015r00000EYB8FAAX","ParentShareholding":80.00,"parentAccountId":"0015r00000EYC4QAAX","idType":"SA Identity Document","Controllinginterest":18.00,"childwrplist":null,"accType":"AccountContact"},{"UBO":"","Type":"Private Company","ShareholderCount":2,"Shareholder":"HFR Properties KZN (pty )Ltd","roles":"Trustees","relatedAccountId":"0015r00000HtjKwAAJ","recordId":"a005r000001u7M3AAI","primaryEntityId":"0015r00000EYC4QAAX","ParentShareholding":100.00,"parentAccountId":"0015r00000EYC4QAAX","idType":"Registration Number","Controllinginterest":22.50,"childwrplist":[{"UBO":"Yes","Type":"Individual","ShareholderCount":0,"Shareholder":"NTEMBEKO NTANTISO MAKALIMA","roles":"Named Beneficiaries","relatedAccountId":"0035r00000C2V0PAAV","recordId":"07k5r000004FVZFAA4","primaryEntityId":"0015r00000EYC4QAAX","ParentShareholding":100.00,"parentAccountId":"0015r00000HtjKwAAJ","idType":"SA Identity Document","Controllinginterest":25.00,"childwrplist":null,"accType":"AccountContact"},{"UBO":"","Type":"Private Company","ShareholderCount":2,"Shareholder":"Capolie Botha Eiendomme (Pty) Ltd","roles":"Shareholder/Controller","relatedAccountId":"0015r00000HtmrpAAB","recordId":"a005r000001u7MDAAY","primaryEntityId":"0015r00000EYC4QAAX","ParentShareholding":100.00,"parentAccountId":"0015r00000HtjKwAAJ","idType":"Registration Number","Controllinginterest":22.50,"childwrplist":[{"UBO":"","Type":"Private Company","ShareholderCount":2,"Shareholder":"Test Light (Pty) Ltd","roles":"Shareholder/Controller","relatedAccountId":"0015r00000Ht94NAAR","recordId":"a005r000001u7MIAAY","primaryEntityId":"0015r00000EYC4QAAX","ParentShareholding":50.00,"parentAccountId":"0015r00000HtmrpAAB","idType":"Registration Number","Controllinginterest":11.25,"childwrplist":[{"UBO":"No","Type":"Individual","ShareholderCount":0,"Shareholder":"Mara Mahlatse","roles":"Shareholder/Controller","relatedAccountId":"0035r00000FMe1oAAD","recordId":"07k5r000004FnpIAAS","primaryEntityId":"0015r00000EYC4QAAX","ParentShareholding":60.00,"parentAccountId":"0015r00000Ht94NAAR","idType":"Passport","Controllinginterest":6.75,"childwrplist":null,"accType":"AccountContact"},{"UBO":"","Type":"Trusts","ShareholderCount":2,"Shareholder":"Mara Trust","roles":"Shareholder/Controller","relatedAccountId":"0015r00000HtrEtAAJ","recordId":"a005r000001u7MSAAY","primaryEntityId":"0015r00000EYC4QAAX","ParentShareholding":50.00,"parentAccountId":"0015r00000Ht94NAAR","idType":"Non-Registered Entity","Controllinginterest":5.62,"childwrplist":[{"UBO":"No","Type":"Individual","ShareholderCount":0,"Shareholder":"JOHANNES HENDRIK BESTER","roles":"Named Beneficiaries","relatedAccountId":"0035r000009TLRHAA4","recordId":"07k5r000004FKs8AAG","primaryEntityId":"0015r00000EYC4QAAX","ParentShareholding":25.00,"parentAccountId":"0015r00000HtrEtAAJ","idType":"SA Identity Document","Controllinginterest":1.41,"childwrplist":null,"accType":"AccountContact"},{"UBO":"No","Type":"Individual","ShareholderCount":0,"Shareholder":"HEIDI MICHELLE WENKE","roles":"Named Beneficiaries","relatedAccountId":"0035r00000DWT7zAAH","recordId":"07k5r000004FKscAAG","primaryEntityId":"0015r00000EYC4QAAX","ParentShareholding":25.00,"parentAccountId":"0015r00000HtrEtAAJ","idType":"SA Identity Document","Controllinginterest":1.41,"childwrplist":null,"accType":"AccountContact"}],"accType":"AccountAccount"}],"accType":"AccountAccount"},{"UBO":"","Type":"Private Company","ShareholderCount":2,"Shareholder":"REcord Hut (Pty) LTd","roles":"Shareholder/Controller","relatedAccountId":"0015r00000Hns30AAB","recordId":"a005r000001u7MNAAY","primaryEntityId":"0015r00000EYC4QAAX","ParentShareholding":50.00,"parentAccountId":"0015r00000HtmrpAAB","idType":"Registration Number","Controllinginterest":11.25,"childwrplist":[{"UBO":"Yes","Type":"Individual","ShareholderCount":0,"Shareholder":"DANISILE DERRICK MBALO","roles":"Shareholder/Controller","relatedAccountId":"0035r00000FNDlXAAX","recordId":"07k5r000004FSneAAG","primaryEntityId":"0015r00000EYC4QAAX","ParentShareholding":100.00,"parentAccountId":"0015r00000Hns30AAB","idType":"SA Identity Document","Controllinginterest":11.25,"childwrplist":null,"accType":"AccountContact"},{"UBO":"Yes","Type":"Individual","ShareholderCount":0,"Shareholder":"Mara Mahlatse","roles":"Shareholder/Controller","relatedAccountId":"0035r00000FMe1oAAD","recordId":"07k5r000004FnGpAAK","primaryEntityId":"0015r00000EYC4QAAX","ParentShareholding":40.00,"parentAccountId":"0015r00000Hns30AAB","idType":"Passport","Controllinginterest":11.25,"childwrplist":null,"accType":"AccountContact"}],"accType":"AccountAccount"}],"accType":"AccountAccount"}],"accType":"AccountAccount"}],"accType":"AccountAccount"}],"accType":"AccountAccount"},{"UBO":"","Type":"Private Company","ShareholderCount":1,"Shareholder":"Test Complex Structure (Pty) Ltd","roles":"Shareholder/Controller","relatedAccountId":"0015r00000DmDe9AAF","recordId":"a005r000001u7SpAAI","primaryEntityId":"0015r00000Ht2mtAAB","ParentShareholding":25.00,"parentAccountId":"0015r00000Ht2mtAAB","idType":"Registration Number","Controllinginterest":25.00,"childwrplist":[{"UBO":"","Type":"Trusts","ShareholderCount":1,"Shareholder":"BOTHA FAMILY TRUST","roles":"Shareholder/Controller","relatedAccountId":"0015J00000F06smQAB","recordId":"a005r000001u9LnAAI","primaryEntityId":"0015r00000Ht2mtAAB","ParentShareholding":100.00,"parentAccountId":"0015r00000DmDe9AAF","idType":null,"Controllinginterest":25.00,"childwrplist":[{"UBO":"","Type":"Close Corporation","ShareholderCount":2,"Shareholder":"Two stone Gardening services cc","roles":"Named Beneficiaries","relatedAccountId":"0015r00000HuCsaAAF","recordId":"a005r000001u9LsAAI","primaryEntityId":"0015r00000Ht2mtAAB","ParentShareholding":100.00,"parentAccountId":"0015J00000F06smQAB","idType":"Registration Number","Controllinginterest":25.00,"childwrplist":[{"UBO":"Yes","Type":"Individual","ShareholderCount":0,"Shareholder":"NTEMBEKO NTANTISO MAKALIMA","roles":"Members/Controllers","relatedAccountId":"0035r00000C2V0PAAV","recordId":"07k5r000004FkojAAC","primaryEntityId":"0015r00000Ht2mtAAB","ParentShareholding":30.00,"parentAccountId":"0015r00000HuCsaAAF","idType":"SA Identity Document","Controllinginterest":32.50,"childwrplist":null,"accType":"AccountContact"},{"UBO":"","Type":"Close Corporation","ShareholderCount":1,"Shareholder":"P and D Trading CC","roles":"Members/Controllers","relatedAccountId":"0015r00000HuCokAAF","recordId":"a005r000001u9LxAAI","primaryEntityId":"0015r00000Ht2mtAAB","ParentShareholding":100.00,"parentAccountId":"0015r00000HuCsaAAF","idType":"Registration Number","Controllinginterest":25.00,"childwrplist":[{"UBO":"Yes","Type":"Individual","ShareholderCount":0,"Shareholder":"A Burgess","roles":"Members/Controllers","relatedAccountId":"0035r00000FNDbMAAX","recordId":"07k5r000004FSjFAAW","primaryEntityId":"0015r00000Ht2mtAAB","ParentShareholding":100.00,"parentAccountId":"0015r00000HuCokAAF","idType":"SA Identity Document","Controllinginterest":25.00,"childwrplist":null,"accType":"AccountContact"}],"accType":"AccountAccount"}],"accType":"AccountAccount"}],"accType":"AccountAccount"}],"accType":"AccountAccount"},{"UBO":"Yes","Type":"Individual","ShareholderCount":0,"Shareholder":"FRANCOIS MARIO WOLVAARDT","roles":"Director;Shareholder/Controller;Operators on primary accounts ( Internet Main Users, Signatories, Card Users)","relatedAccountId":"0035r00000FMaS4AAL","recordId":"07k5r000004FAwoAAG","primaryEntityId":"0015r00000Ht2mtAAB","ParentShareholding":25.00,"parentAccountId":"0015r00000Ht2mtAAB","idType":"SA Identity Document","Controllinginterest":25.00,"childwrplist":null,"accType":"AccountContact"}],"accType":"Account"}]';
		insert account;
         
        string accHierarchy=[SELECT UBO_ParentAccountWrapper__c FROM Account LIMIT 1].UBO_ParentAccountWrapper__c;
        system.assert(accHierarchy !='', 'UBO_ParentAccountWrapper__c should not be empty');
        
        Set<Id> IdsSet =new Set<Id>();        
        IdsSet=OnboardingMainUtil.getParticipantsData(accHierarchy);
        system.assert(IdsSet.size() > 0,'Set of ids should be greater than zero');
        
        OnboardingMainUtil.AccountWrapper accWrapper=new OnboardingMainUtil.AccountWrapper();
        accWrapper.Shareholder='';
        accWrapper.Type='';
        accWrapper.idType='';
        accWrapper.ShareholderCount=0;
        accWrapper.ParentShareholding=0.0;
        accWrapper.Controllinginterest=0.0;
        accWrapper.roles='';
        accWrapper.relatedAccountId='';
        accWrapper.parentAccountId='';
        accWrapper.primaryEntityId='';
        
        OnboardingMainUtil.ParentAccountWrapper parentAccWrapper=new OnboardingMainUtil.ParentAccountWrapper();
        parentAccWrapper.Shareholder='';
        parentAccWrapper.Type='';
        parentAccWrapper.ShareholderCount=0;
        parentAccWrapper.ParentShareholding=0.0;
        parentAccWrapper.Controllinginterest=0.0;
        parentAccWrapper.accType='';
       
    }
}