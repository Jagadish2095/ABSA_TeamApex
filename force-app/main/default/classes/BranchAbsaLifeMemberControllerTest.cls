/**
* @description Test Class for Absa Life Member Controller
* @author  Onthatile
* @created 2021-10-13
*/

@isTest
public class BranchAbsaLifeMemberControllerTest {

    public static final String POSITIVE_RESPONSE_GET_PRODUCT = '{"Product_GetResponse":{"Product_GetResult":{"Benefits":{"BenefitOption":[{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},{"Cover":0,"FormID":"","ID":250021000,"IsDefault":false,"Name":"Spouse","Premium":0,"Target":{"ID":2,"Name":"Spouse","SubType":"Dependent","Type":"Spouse"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":50},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":70},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":90},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":110},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":160},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":215}]}},{"Cover":0,"FormID":"","ID":250022000,"IsDefault":false,"Name":"Child","Premium":0,"Target":{"ID":3,"Name":"Child","SubType":"Dependent","Type":"Child"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":20},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":25},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":30},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":35}]}},{"Cover":0,"FormID":"","ID":250023000,"IsDefault":false,"Name":"Parent","Premium":0,"Target":{"ID":4,"Name":"Parent","SubType":"Dependent","Type":"Other"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":75},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":110},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":145},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":180}]}}]},"CommissionRules":"","ContractOptions":{"ContractOption":[{"Benefits":{"BenefitOption":[{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},{"Cover":0,"FormID":"","ID":250021000,"IsDefault":false,"Name":"Spouse","Premium":0,"Target":{"ID":2,"Name":"Spouse","SubType":"Dependent","Type":"Spouse"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":50},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":70},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":90},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":110},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":160},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":215}]}},{"Cover":0,"FormID":"","ID":250022000,"IsDefault":false,"Name":"Child","Premium":0,"Target":{"ID":3,"Name":"Child","SubType":"Dependent","Type":"Child"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":20},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":25},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":30},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":35}]}},{"Cover":0,"FormID":"","ID":250023000,"IsDefault":false,"Name":"Parent","Premium":0,"Target":{"ID":4,"Name":"Parent","SubType":"Dependent","Type":"Other"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":75},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":110},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":145},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":180}]}}]},"Default":{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},"FormID":"","ID":250000001,"IsDefault":false,"Key":250000001,"Name":"Option 01: R 400","PremiumRules":""},{"Benefits":{"BenefitOption":[{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},{"Cover":0,"FormID":"","ID":250021000,"IsDefault":false,"Name":"Spouse","Premium":0,"Target":{"ID":2,"Name":"Spouse","SubType":"Dependent","Type":"Spouse"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":50},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":70},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":90},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":110},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":160},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":215}]}},{"Cover":0,"FormID":"","ID":250022000,"IsDefault":false,"Name":"Child","Premium":0,"Target":{"ID":3,"Name":"Child","SubType":"Dependent","Type":"Child"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":20},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":25},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":30},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":35}]}},{"Cover":0,"FormID":"","ID":250023000,"IsDefault":false,"Name":"Parent","Premium":0,"Target":{"ID":4,"Name":"Parent","SubType":"Dependent","Type":"Other"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":75},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":110},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":145},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":180}]}}]},"Default":{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},"FormID":"","ID":250000002,"IsDefault":false,"Key":250000002,"Name":"Option 02: R 600","PremiumRules":""},{"Benefits":{"BenefitOption":[{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},{"Cover":0,"FormID":"","ID":250021000,"IsDefault":false,"Name":"Spouse","Premium":0,"Target":{"ID":2,"Name":"Spouse","SubType":"Dependent","Type":"Spouse"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":50},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":70},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":90},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":110},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":160},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":215}]}},{"Cover":0,"FormID":"","ID":250022000,"IsDefault":false,"Name":"Child","Premium":0,"Target":{"ID":3,"Name":"Child","SubType":"Dependent","Type":"Child"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":20},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":25},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":30},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":35}]}},{"Cover":0,"FormID":"","ID":250023000,"IsDefault":false,"Name":"Parent","Premium":0,"Target":{"ID":4,"Name":"Parent","SubType":"Dependent","Type":"Other"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":75},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":110},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":145},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":180}]}}]},"Default":{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},"FormID":"","ID":250000003,"IsDefault":false,"Key":250000003,"Name":"Option 03: R 800","PremiumRules":""},{"Benefits":{"BenefitOption":[{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},{"Cover":0,"FormID":"","ID":250021000,"IsDefault":false,"Name":"Spouse","Premium":0,"Target":{"ID":2,"Name":"Spouse","SubType":"Dependent","Type":"Spouse"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":50},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":70},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":90},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":110},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":160},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":215}]}},{"Cover":0,"FormID":"","ID":250022000,"IsDefault":false,"Name":"Child","Premium":0,"Target":{"ID":3,"Name":"Child","SubType":"Dependent","Type":"Child"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":20},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":25},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":30},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":35}]}},{"Cover":0,"FormID":"","ID":250023000,"IsDefault":false,"Name":"Parent","Premium":0,"Target":{"ID":4,"Name":"Parent","SubType":"Dependent","Type":"Other"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":75},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":110},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":145},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":180}]}}]},"Default":{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},"FormID":"","ID":250000004,"IsDefault":false,"Key":250000004,"Name":"Option 04: R 1000","PremiumRules":""},{"Benefits":{"BenefitOption":[{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},{"Cover":0,"FormID":"","ID":250021000,"IsDefault":false,"Name":"Spouse","Premium":0,"Target":{"ID":2,"Name":"Spouse","SubType":"Dependent","Type":"Spouse"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":50},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":70},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":90},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":110},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":160},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":215}]}},{"Cover":0,"FormID":"","ID":250022000,"IsDefault":false,"Name":"Child","Premium":0,"Target":{"ID":3,"Name":"Child","SubType":"Dependent","Type":"Child"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":20},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":25},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":30},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":35}]}},{"Cover":0,"FormID":"","ID":250023000,"IsDefault":false,"Name":"Parent","Premium":0,"Target":{"ID":4,"Name":"Parent","SubType":"Dependent","Type":"Other"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":75},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":110},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":145},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":180}]}}]},"Default":{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},"FormID":"","ID":250000005,"IsDefault":false,"Key":250000005,"Name":"Option 05: R 1500","PremiumRules":""},{"Benefits":{"BenefitOption":[{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},{"Cover":0,"FormID":"","ID":250021000,"IsDefault":false,"Name":"Spouse","Premium":0,"Target":{"ID":2,"Name":"Spouse","SubType":"Dependent","Type":"Spouse"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":50},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":70},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":90},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":110},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":160},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":215}]}},{"Cover":0,"FormID":"","ID":250022000,"IsDefault":false,"Name":"Child","Premium":0,"Target":{"ID":3,"Name":"Child","SubType":"Dependent","Type":"Child"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":20},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":25},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":30},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":35}]}},{"Cover":0,"FormID":"","ID":250023000,"IsDefault":false,"Name":"Parent","Premium":0,"Target":{"ID":4,"Name":"Parent","SubType":"Dependent","Type":"Other"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":75},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":110},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":145},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":180}]}}]},"Default":{"Cover":0,"FormID":"","ID":250020000,"IsDefault":false,"Name":"Main Member","Premium":0,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"CoverOptions":{"CoverOption":[{"Cover":0,"IsDefault":false,"Name":"","Premium":0},{"Cover":400,"IsDefault":true,"Name":"R 400","Premium":0},{"Cover":600,"IsDefault":false,"Name":"R 600","Premium":0},{"Cover":800,"IsDefault":false,"Name":"R 800","Premium":0},{"Cover":1000,"IsDefault":false,"Name":"R 1000","Premium":0},{"Cover":1500,"IsDefault":false,"Name":"R 1500","Premium":0},{"Cover":2000,"IsDefault":false,"Name":"R 2000","Premium":0}]}},"FormID":"","ID":250000006,"IsDefault":false,"Key":250000006,"Name":"Option 06: R 2000","PremiumRules":""}]},"LoadingOptions":"","PremiumRules":"","ProductIdentifier":250000000,"ProductName":"ABSA Health Assistance Cover","Targets":{"PolicyTarget":[{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},{"ID":2,"Name":"Spouse","SubType":"Dependent","Type":"Spouse"},{"ID":3,"Name":"Child","SubType":"Dependent","Type":"Child"},{"ID":4,"Name":"Parent","SubType":"Dependent","Type":"Other"}]},"UnderwritingOptions":"","ValidationRules":{"ValidationRule":[{"Maximum":65,"Minimum":18,"Target":{"ID":1,"Name":"Main Member","SubType":"Main","Type":"Main"},"ValidationType":"Age"},{"Maximum":65,"Minimum":18,"Target":{"ID":2,"Name":"Spouse","SubType":"Dependent","Type":"Spouse"},"ValidationType":"Age"},{"Maximum":25,"Minimum":0,"Target":{"ID":3,"Name":"Child","SubType":"Dependent","Type":"Child"},"ValidationType":"Age"},{"Maximum":65,"Minimum":40,"Target":{"ID":4,"Name":"Parent","SubType":"Dependent","Type":"Other"},"ValidationType":"Age"}]}}}}';
    public static final String POSITIVE_RESPONSE_POLICY = '{"CalculateResponse":{"CalculateResult":{"UnderwritingItems":null,"TotalPremium":"65","TotalCover":"400","TotalCommission":0,"SpousesString":null,"Spouses":null,"Spouse":{"GUID":"e320b2d9-3827-44df-be1a-f0ac2cee3fb6","Age":2020,"DateOfBirth":"0001-01-01T00:00:00","FirstName":"","FullName":",","Gender":"Unknown","Initials":"","MemberType":"Unknown","Name":",","Names":"","RsaIdNumber":"","ShortName":"","Surname":"","Title":"Unknown","Benefit":{"GUID":"5b32a3ec-1f77-40f7-9419-0669cd8d37d1","BenefitID":230120000,"Cover":15000,"CoverIncrease":5,"Loadings":0,"Option":0,"Premium":0,"PremiumIncrease":5,"PremiumLoadings":null,"TotalPremium":0},"BenefitOption":0,"Benefits":{"Benefit":[{"GUID":"5b32a3ec-1f77-40f7-9419-0669cd8d37d1","BenefitID":230120000,"Cover":15000,"CoverIncrease":5,"Loadings":0,"Option":0,"Premium":0,"PremiumIncrease":5,"PremiumLoadings":null,"TotalPremium":0}]},"Cover":15000,"Loadings":0,"Premium":0,"Relationship":"SPOUSE","Passport":""},"Signatories":null,"Premium":"65","PolicyInfo":{"State":"Draft","ProposalNumber":null,"PolicyNumber":null,"Name":"ABSA Health Assistance Cover","Issue":"2021-08-29T12:45:07.0705227+02:00","Inception":"2021-10-01T00:00:00","GUID":"42d19400-9973-4209-81ba-fa291b674053","ErrorReasons":null,"ErrorReason":null,"Disclosure":"false","ContractOptionID":"250000001","ContractID":"250000000","Application":"2021-08-29T12:30:00.5727821+02:00"},"PolicyBenefit":{"TotalPremium":"65","PremiumLoadingsString":null,"PremiumLoadings":null,"PremiumIncrease":"5","Premium":"65","Option":"0","Loadings":"0","GUID":"c9aaa285-709e-48b1-9f53-2117b42dd5b3","CoverIncrease":"5","Cover":"400","BenefitID":"250020000"},"ModuleID":"WIMAL00102","MainMember":{"Title":"Unknown","Surname":"Herceg","ShortName":"C Herceg","RsaIdNumber":"5111117093088","Names":"Cvitko, C","Name":"Herceg, Cvitko","MemberType":"Individual","Initials":"C","GUID":"7b0eede1-fc1f-434a-b573-a26f27067617","Gender":"Male","FullName":"Herceg, Cvitko","FirstName":"Cvitko","DateOfBirth":"1951-11-11T00:00:00","Age":"69","WillNumber":null,"SourceOfIncome":"20","SourceOfFunds":"20","Premium":"65","Occupation":null,"Nationality":"SOU01","MaritalStatus":"Single","Loadings":"0","Language":"Unknown","IsStaff":"false","IsSouthAfrican":"true","IsIndividual":"true","IncomeBand":"Unknown","EmailAddress":null,"Cover":"400","CountryOfResidence":"SO003","CountryOfBirth":"SO003","ContactDetails":{"WorkTelephone":null,"PostalAddress":{"SingleLine":"1738 PRESIDENT ST, JOHANNESBURG","PostalCode":"2090","Line4":null,"Line3":"JOHANNESBURG","Line2":null,"Line1":"1738 PRESIDENT ST","GUID":"bd10277d-d4cd-46af-b9aa-e9e09757c439"},"PhysicalAddress":{"SingleLine":"1738 PRESIDENT STREET, JOHANNESBURG","PostalCode":"2090","Line4":null,"Line3":"JOHANNESBURG","Line2":null,"Line1":"1738 PRESIDENT STREET","GUID":"dd179f81-0152-4002-83b8-ef8feb34615f"},"OptIn":"false","HomeTelephone":null,"GUID":"411e2ba3-5abd-4b40-8ff4-d17b0d59d7fd","EmailAddress":"cvitkoherceg@rhyta.com","CellTelephone":"0783452367"},"CifClientCode":"HERCEC 001","CasaReferenceNumber":"121267034","Benefits":{"BenefitObj":null,"Benefit":[{"TotalPremium":"65","PremiumLoadingsString":null,"PremiumLoadings":null,"PremiumIncrease":"5","Premium":"65","Option":"0","Loadings":"0","GUID":"c9aaa285-709e-48b1-9f53-2117b42dd5b3","CoverIncrease":"5","Cover":"400","BenefitID":"250020000"}]},"BenefitOption":"0","BenefitObj":null,"Benefit":{"TotalPremium":"65","PremiumLoadingsString":null,"PremiumLoadings":null,"PremiumIncrease":"5","Premium":"65","Option":"0","Loadings":"0","GUID":"c9aaa285-709e-48b1-9f53-2117b42dd5b3","CoverIncrease":"5","Cover":"400","BenefitID":"250020000"}},"Loadings":"0","GUID":"a687c5b0-7adb-4873-8cf1-ca808c1d0ae8","Flags":{"KeyValueOfstringstring":[{"Value":"False","Key":"IncludeParent"},{"Value":"False","Key":"IncludeSpouse"},{"Value":"False","Key":"IncludeChildren"},{"Value":"True","Key":"AnnualCoverPremiumIncrease"}]},"Dependents":null,"DebitDetails":{"ThirdParty":"false","SalaryDay":"0","GUID":"9e4b1a09-afa6-44d9-b425-b9da85ecfc74","DebitDay":"0","DebitDate":"0001-01-01T00:00:00","DebitAccountNumber":null,"BranchClearingCode":null,"Branch":null,"Bank":null,"AccountType":"Cheque","AccountHolder":null},"Cover":"400","Children":null,"Beneficiaries":null,"Application":{"Replacement":{"ReplacementDate":null,"PolicyNumber":null,"IsReplacement":"false","GUID":"e517d208-896f-4257-aa28-6d53faa53b33","Company":null},"IsClientPresent":"true","IsBranchSales":"true","GUID":"3811e0fd-c6a5-426a-8ba4-5c06b2571d97","DistributionChannel":"BranchSales","Declaration":{"Supervisor":null,"Name":null,"IsSupervised":"false","IsFit":"false","GUID":"af1ea367-d97e-453f-aef9-90109417e3f8","Advice":"false"},"Consultant":{"SiteCode":"8007","PRINumber":null,"Name":"Tumi Mokomane","IntermediaryCode":null,"GUID":"9192464f-cb25-4cbb-b7fb-d4d2eeb0221e","EmployeeNumber":"5035555","Branch":null,"ABNumber":"abbmago"},"Agent":{"SiteCode":null,"RsaIdNumber":null,"PRINumber":null,"Name":null,"GUID":"65c240af-8d46-45c3-b80a-70e7f49f3443","EmployeeNumber":null,"DistributionChannel":"BranchSales"}}}}}';
    
    @testSetup
    static void makeData() {
        
        IntegrationTestDataFactory.insertIntegrationTranslations();
        IntegrationTestDataFactory.insertIntegrationSettings(StringConstants.API_MANAGER, 
                                                             new list<String> {
                                                                 StringConstants.WBIF_POLICY_CREATE, 
                                                                     StringConstants.WBIF_CALCULATE_V2, 
                                                                     StringConstants.WBIF_POLICY_ADD_BENEFIT_V2, 
                                                                     StringConstants.WBIF_POLICY_ADD_DEPENDENT, 
                                                                     StringConstants.WBIF_AMCDF_PRODUCTGET,
                                                                     StringConstants.WBIF_POLICY_ADD_BENEFICIARY, 
                                                                     StringConstants.WBIF_VALIDATE_POLICY, 
                                                                     StringConstants.WBIF_SUBMIT_POLICY,
                                                                     BranchPolicyRemovalService.PolicyBenefit_SERVICE_NAME,
                                                                     BranchPolicyRemovalService.BeneficiryaDelete_SERVICE_NAME,
                                                                     BranchPolicyRemovalService.PolicyDependent_SERVICE_NAME });
        
        BranchAbsaLifeTestDataFactory testDataFactory = new BranchAbsaLifeTestDataFactory();
        Account testAccount = testDataFactory.CreateAccount();
        
        testDataFactory.AddAddress(testAccount.Id, 'South Africa', 'CAPE TOWN', '01 PUERTA DEL SOL', '8001', 'Residential');
        testDataFactory.AddAddress(testAccount.Id, 'South Africa', 'GROBLERSDAL', '01 MABOPANE SECTION', '1060', 'Postal');
        
        Opportunity mainOpportunity = testDataFactory.CreateAbsaLifeOpportunity(testAccount.Name, testAccount.Id);
        PricebookEntry flexProductPriceBook = testDataFactory.CreateWimiProduct('Flexi Funeral', 'WIMAL00103');
        testDataFactory.CreateApplicationForOpportunity(mainOpportunity.Id);
        testDataFactory.CreateOpportunityLineItem(mainOpportunity.Id, flexProductPriceBook);

        testDataFactory.AddPartyMembers('Spouse', mainOpportunity.Id, 'Flexi Funeral');
        testDataFactory.AddPartyMembers('Beneficiary', mainOpportunity.Id, 'Flexi Funeral');
    }
    
    @IsTest
    static void testGetPolicyDetailsNoPreviousInsurer() {
        Test.setMock(HttpCalloutMock.class, new Sys_Utilities_Integration_Mock_ApiRest(StringConstants.POSITIVE_STRING, POSITIVE_RESPONSE_GET_PRODUCT));
        
        
        Test.startTest();   
        BranchAbsaLifeTestDataFactory testDataFactory = new BranchAbsaLifeTestDataFactory();
        String  opportunityProductId = testDataFactory.GetOpportunityProductId('WIMAL00103');
        BranchPolicyDetails serviceResp = BranchAbsaLifeMemberController.getPolicyDetails(opportunityProductId, null);
        System.assertNotEquals(null,serviceResp);
        System.assertNotEquals(null,serviceResp.Policy);
        Test.stopTest();
    }
    
    
    @IsTest
    static void testGetPolicyDetailsWithPreviousInsurer() {
        Test.setMock(HttpCalloutMock.class, new Sys_Utilities_Integration_Mock_ApiRest(StringConstants.POSITIVE_STRING, POSITIVE_RESPONSE_GET_PRODUCT));

        Test.startTest();
                
        BranchAbsaLifeTestDataFactory testDataFactory = new BranchAbsaLifeTestDataFactory();
        String  opportunityProductId = testDataFactory.GetOpportunityProductId('WIMAL00103');
        BranchPolicyDetails serviceResp = BranchAbsaLifeMemberController.getPolicyDetails(opportunityProductId, '{"Terminated":"Yes","PolicyCover":"50000","Duration":"1-6 months","PreviousInsurer":"Test"}');
        System.assertNotEquals(null,serviceResp);
        System.assertNotEquals(null,serviceResp.Policy);
        Test.stopTest();
    }
    
    @IsTest
    static void testAddOrUpdateBeneficiaries(){
        Test.setMock(HttpCalloutMock.class, new Sys_Utilities_Integration_Mock_ApiRest(StringConstants.POSITIVE_STRING, POSITIVE_RESPONSE_POLICY));
        
        String beneficiaryData = '{"PartyId":"0","Name":"Thabo","Surname":"AZola","Relationship":"Child","IDNumber":"9101300023089","IdType":"01","Gender":"Female","DateOfBirth":"1991-01-30","MemberType":"Child"}';
        Test.startTest();

        BranchAbsaLifeTestDataFactory testDataFactory = new BranchAbsaLifeTestDataFactory();
        String  opportunityProductId = testDataFactory.GetOpportunityProductId('WIMAL00103');
        String policyDataString = testDataFactory.GetPolicyDataString();

        BranchPolicyDetails serviceResp = BranchAbsaLifeMemberController.addOrUpdateBeneficiaries(policyDataString, BranchAbsaLifeTestDataFactory.MemberDataString, opportunityProductId);
        
        System.assertNotEquals(null,serviceResp);
        Test.stopTest();
    }

    @IsTest
    static void CalculateMembersPremium() {
        Test.setMock(HttpCalloutMock.class, new Sys_Utilities_Integration_Mock_ApiRest(StringConstants.POSITIVE_STRING, POSITIVE_RESPONSE_POLICY));
        
        Test.startTest();
        BranchAbsaLifeTestDataFactory testDataFactory = new BranchAbsaLifeTestDataFactory();
        String  opportunityProductId = testDataFactory.GetOpportunityProductId('WIMAL00103');

        String policyDataString = testDataFactory.GetPolicyDataString();
        BranchPolicyDetails serviceResp = BranchAbsaLifeMemberController.calculateMembersPremium(policyDataString, BranchAbsaLifeTestDataFactory.MemberDataString, opportunityProductId);
        System.assertNotEquals(null, serviceResp);
        System.assertNotEquals(null,serviceResp.Policy);
        Test.stopTest();
    }
    @IsTest
    static void testDeletePolicyBenefit() {
        String DeleteBenefitResponse = '{"Policy_DeleteBenefitResponse" : { "PolicyBenefitResult" :' + BranchAbsaLifeTestDataFactory.PolicyDataString + '}}}';
        Test.setMock(HttpCalloutMock.class, new Sys_Utilities_Integration_Mock_ApiRest(StringConstants.POSITIVE_STRING, DeleteBenefitResponse));
        
        Test.startTest();
        BranchAbsaLifeTestDataFactory testDataFactory = new BranchAbsaLifeTestDataFactory();
        String policyDataString = testDataFactory.GetPolicyDataString();
        BranchPolicyDetails serviceResp = BranchAbsaLifeMemberController.deletePolicyBenefit(policyDataString, BranchAbsaLifeTestDataFactory.MemberDataString);
        System.assertNotEquals(null, serviceResp);
        System.assertNotEquals(null,serviceResp.Policy);
        Test.stopTest();
    }
    
    @IsTest
    static void testDeletePolicyBeneficiary() {

        String DeleteBeneficiaryResponse = '{"Policy_DeleteBeneficiaryResponse" : { "PolicyBeneficiaryResult" :' + BranchAbsaLifeTestDataFactory.PolicyDataString + '}}}';
        Test.setMock(HttpCalloutMock.class, new Sys_Utilities_Integration_Mock_ApiRest(StringConstants.POSITIVE_STRING, DeleteBeneficiaryResponse));
        
        Test.startTest();
        BranchAbsaLifeTestDataFactory testDataFactory = new BranchAbsaLifeTestDataFactory();
        String policyDataString = testDataFactory.GetPolicyDataString();
        BranchPolicyDetails serviceResp = BranchAbsaLifeMemberController.deletePolicyBeneficiary(policyDataString, BranchAbsaLifeTestDataFactory.MemberDataString);
        System.assertNotEquals(null, serviceResp);
        System.assertNotEquals(null,serviceResp.Policy);
        Test.stopTest();
    }

    @IsTest
    static void testdeleteDependentFromPolicy() {

        String DeleteDependentResponse = '{"Policy_DeleteDependentResponse" : { "PolicyDependentResult" :' + BranchAbsaLifeTestDataFactory.PolicyDataString + '}}}';
        Test.setMock(HttpCalloutMock.class, new Sys_Utilities_Integration_Mock_ApiRest(StringConstants.POSITIVE_STRING, DeleteDependentResponse));
        
        Test.startTest();
        BranchAbsaLifeTestDataFactory testDataFactory = new BranchAbsaLifeTestDataFactory();
        String policyDataString = testDataFactory.GetPolicyDataString();
        BranchPolicyDetails serviceResp = BranchAbsaLifeMemberController.deleteDependentFromPolicy(policyDataString, BranchAbsaLifeTestDataFactory.MemberDataString);
        System.assertNotEquals(null, serviceResp);
        System.assertNotEquals(null,serviceResp.Policy);
        Test.stopTest();
    }

    @IsTest
    static void submitPolicyDetailsTest(){
        
        Test.setMock(HttpCalloutMock.class, new Sys_Utilities_Integration_Mock_ApiRest(StringConstants.POSITIVE_STRING, POSITIVE_RESPONSE_POLICY));
        
        Test.startTest();
        BranchAbsaLifeTestDataFactory testDataFactory = new BranchAbsaLifeTestDataFactory();
        String policyDataString = testDataFactory.GetPolicyDataString();
        String opportunityProductId = testDataFactory.GetOpportunityProductId('WIMAL00103');

        BranchAbsaLifeMemberController.submitPolicyDetails(opportunityProductId, policyDataString);
        System.assertNotEquals(opportunityProductId, null);
        Test.stopTest();
    }

    @IsTest
    static void getTranslationValuesTest(){
        Test.startTest();
        Map<String, String> maps = BranchAbsaLifeMemberController.getTranslationValues('CIF','Identity Type','Outbound');
        System.assert(maps.size() > 0, 'Has Data');
        Test.stopTest();
    }
    
}