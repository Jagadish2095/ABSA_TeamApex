/**
 * @description       : Test class for PowerCurveUpdateController3And5
 * @author            : Himani Joshi
 * @last modified on  : 2021-12-07
 * @last modified by  : Himani Joshi
**/

@IsTest
public class PowerCurveUpdateController3And5Test {
    /**
    * @description 
    * @author Himani Joshi | 2021-12-07 
    **/
    @testSetup
    public static void dataCreation() {
        //FinancialInformationTriggerTest.FinancialInfoTriggertest();
        //PowerCurveUpdateController2Test.testData();

        List<Account> accounts = new List<Account>();
        Account account = new Account();
        account.Name = 'Test Account';
        account.Client_Type__c = 'Sole Trader';
        account.CIF__c = 'SNIFFEL001';
        account.Sic = '35790';
        account.AccountNumber = '0';
        account.Registration_Number__c = '1990/011515/23';
       	accounts.add(account);

        Account spouseAcc = new Account();
        spouseAcc.Name = 'Spouse Account';
        spouseAcc.Client_Type__c = 'Private Individual';
        spouseAcc.CIF__c = 'SNIFF01';
        spouseAcc.Sic = '36798';
        spouseAcc.AccountNumber = '0';
        spouseAcc.Registration_Number__c = '1990/077515/99';
        spouseAcc.VAT_Registration_Number__c = 077515;
        spouseAcc.Trading_Name__c = '';
        spouseAcc.ID_Type__c = 'SA Identity Document';
        spouseAcc.Is_Spouse_Contribute__c = true;
        accounts.add(spouseAcc);

        Account pr1Acc = new Account();
        pr1Acc.Name = 'Principle1 Account';
        pr1Acc.Client_Type__c = 'Private Individual';
        pr1Acc.CIF__c = 'SNIFTTF01';
        pr1Acc.Sic = '36690';
        pr1Acc.AccountNumber = '0';
        pr1Acc.Registration_Number__c = '8493/077515/99';
        pr1Acc.ID_Type__c = 'Registration Number';
        accounts.add(pr1Acc);
        insert accounts;

        Opportunity opp = new Opportunity();
        opp.Name = 'Test Opp Onboarding 1';
        opp.CloseDate = Date.today();
        opp.StageName = 'New';
        opp.AccountId = account.Id;
        opp.Spouse_Account_Id__c = spouseAcc.Id;
        insert opp;

        Application__c app = new Application__c();
        app.Opportunity__c = opp.id;
        app.Account_Access__c = 'Cellphone';
        app.Surplus_Cash__c = 'Fixed Deposits';
        app.Borrowing_Requiment_General__c = 'Credit Card';
        app.Protection_Of_Services__c = 'Retirement';
        app.Title__c = 'dd';
        app.FirstNameSignature__c = 'Litha';
        app.SurnameSignature__c = 'Nosekeleza';
        app.Signing_Date__c = System.today();
        app.Stock_Number__c = '';
        insert app;

		opp = new OpportunitiesSelector().selectByOppId(opp.Id);

        Account acc = [SELECT Id FROM Account WHERE Name = 'Test Account' LIMIT 1];

        Application_Principal__c appPrin = new Application_Principal__c();
		appPrin.Application__c = app.Id;
		appPrin.Casa_Reference__c = pr1Acc.CASA_Reference_Number__c;
		appPrin.Casa_Result__c = pr1Acc.CASA_Screening_Status__c;
		appPrin.CIF__c = pr1Acc.CIF__c;
		appPrin.Controlling_Interest__c = 10;
		appPrin.Id_Number__c = '';
		appPrin.Main__c = true;
		appPrin.Principal_Shareholder_Name__c = pr1Acc.Name;
        insert appPrin;

        List<Application_Profile__c> appProfileList = new List<Application_Profile__c>();
        Application_Profile__c appProfile = new Application_Profile__c();
        appProfile.Applicant_Type__c = 'Main Applicant';
        appProfile.Is_Main_Applicant__c = true;
        appProfile.Client_CIF_Code__c = 'Test03823';
        appProfile.Client_Name__c = 'Test';
        appProfile.KIMNumber__c = 1234;
        appProfile.Application__c = app.Id;
        appProfile.Account__c = acc.Id;
        appProfileList.add(appProfile);

        appProfile = new Application_Profile__c();
        appProfile.Applicant_Type__c = 'Spouse';
        appProfile.Is_Main_Applicant__c = false;
        appProfile.Client_CIF_Code__c = 'SNQWFEL001';
        appProfile.Client_Name__c = 'Test';
        appProfile.KIMNumber__c = 12345;
        appProfile.Application__c = app.Id;
        appProfile.Account__c = spouseAcc.Id;
        appProfileList.add(appProfile);

        appProfile = new Application_Profile__c();
        appProfile.Applicant_Type__c = 'Principal';
        appProfile.Is_Main_Applicant__c = false;
        appProfile.Client_CIF_Code__c = 'SNIFFEL001';
        appProfile.Client_Name__c = 'Test';
        appProfile.KIMNumber__c = 12346;
        appProfile.Application__c = app.Id;
        appProfile.Account__c = spouseAcc.Id;
        appProfileList.add(appProfile);
        insert appProfileList;

        Financial_Information__c finrec = new Financial_Information__c();
		finrec.Status__c = 'Verified Complete';
		finrec.Account__c = acc.id;
		finrec.Auditor_s_Certificate_Date__c = date.today().adddays(-15);
		finrec.Client_Name__c = 'abcd';
		finrec.Date_Financials_Signed_Client__c = date.today().adddays(-15);
		finrec.Financial_Statement_Qualified_Issue__c = 'YES';
		finrec.Financial_Statement_Type__c = 'Audited - Qualified';
		finrec.Statement_Date_Year_end__c = date.today().adddays(-15);
		finrec.Year_Selection__c = 'Year1';
		finrec.Month_With_Highest_Debit_Balance__c = '02/2021';
		finrec.Month_with_highest_shortfall__c = '02/2021';
		finrec.Intangible_Assets__c = 2000000;
        finrec.Land_Bank__c = 433300;
		finrec.Loans_from_Associates__c = 250000;
		finrec.Loans_from_Principals_Ceded__c = 32000;
		finrec.Loans_from_Principals_Non_Ceded__c = 420000;
		finrec.Loans_to_Principals_Associates__c = 340000;
		finrec.Other_Assets__c = 2000;
		finrec.Other_Current_Assets__c = 12000;
		finrec.Other_Current_Liabilities__c = 20000;
		finrec.Other__c = 25000;
		finrec.Revaluation_Of_Assets__c = 20000;
		finrec.Total_Fixed_Investments_Cash_and_Market__c = 400000;
		finrec.Cash_Marketable_Securities__c = 100000;
		finrec.Property_Plant_Equipment__c = 100000;
		finrec.Shareholders_Funds_Capital_Account__c = 100000;
		insert finrec;

        Application_Assets_and_Liabilities__c assLiab = new Application_Assets_and_Liabilities__c();
		//assLiab.Name = 'a1x3N000000Rn7a';
		assLiab.Application__c = app.Id;
		assLiab.Primary_Owner__c = acc.Id;
        assLiab.Type__c = 'Notarial Bond Amount';
		insert assLiab;

        List<Address__c> addresses = new List<Address__c>();
        Address__c addressAcc = new Address__c();
        addressAcc.Address_Type__c = 'Residential';
        addressAcc.Address1__c = 'Address1c';
        addressAcc.Address2__c = 'Address2c';
        addressAcc.Billing_Suburb__c = 'BillingSuburbc';
        addressAcc.Billing_City__c = 'BillingCityc';
        addressAcc.Billing_Zip_Postal_Code__c = '2000';
        addressAcc.Shipping_Street__c = 'ShippingStreetc';
        addressAcc.Shipping_Suburb__c = 'Marshalltown';
        addressAcc.Shipping_City__c = 'Johannesburg';
        addressAcc.Shipping_Zip_Postal_Code__c = '1491';
        addressAcc.Account__c = acc.Id;
        addresses.add(addressAcc);
        insert addresses;

        Application_Security__c appSec = new Application_Security__c();
        appSec.Specific__c = 'Y';
        appSec.Client_Code__c = 'SNIFFEL001';
        appSec.ASV__c = 5;
        appSec.ASV_MASV__c = 5;
        appSec.Bond_Type__c = 'Bond';
        appSec.Application__c = app.Id;
        appSec.Application_Id_Text__c = app.Id;
        appSec.Security_Type__c = 'Suretyship';
        insert appSec;
    }

    
     /**
     * @description 
     * @author Himani Joshi | 2021-12-07 
     **/
     @isTest static void testAllMethods() {
        String request = '{"Request":{"ApplicationDV":{"RequestedProducts01":{"INTPRDNEWF":{},"APPPRDNEWF":{"SETTLEMENTSAMNT":"0","REQTOTALAMNT":"100000","REQTERMOFLOAN":"0","REQREQEMPOWERMNTFUNDIND":"Y","REQREQEMPOWERMNTFUND":"002","REQREPAYMNTOPTION":"0","REQREDUCTIONFREQ":"0","REQREDUCTIONAMNT":"0","REQPRODUCT":"CHQ","REQPRODTYPE":"11016","REQPRODCOMBINATIONNUM":"0","REQPAYMNTMETHOD":"D","REQONCEOFFFREQAMNT":"0","REQODLIMITTYPE":"4","REQNUMSKIPPEDPAYMNTS":"0","REQLIMITTYPEIND":"","REQLIMIT":"100000","REQINSTALLMENTFREQ":"0","REQINITIATIONFEEPAYMNTMETHOD":"D","REQFACILITYTYPE":"0","REQCREDLIFEPREMIUM":"0","REQCAMPAIGNCODE":"","REQADDITIONALAMNT":"0","INSTSETTLEMENTS":"0","ESPINSTRUCTION":"","CARDTYPE":"","APPLICATIONSTATUS":"P"}},"INTAPPSICCODE":"50100","INTAPPOVERALLCONTROLBRANCH":"3840","INTAPPEXISTINGFRANCHISORTYPE":"425","INTAPPEXISTINGFRANCHISEFINANCING":"Y","INTAPPENTERPRDEVFUNDEXISTING":"TSAFRIC048","INTAPPBUSINESSSUBSEGMENT":"S","INTAPPBUSINESSSEGMENT":"F","INTAPPBRANCHCODE":"8198","ExistingProducts01":{"INTPRDSECE":{"SPECASVLIMITED":"0","SPECASVFULL":"0"},"INTPRDEXST":{"SECUREDBYMORTGAGEBOND":"N","PRODUCTTYPE":"11019","PRODUCT":"CHQ","NCAMAXINITFEEAMNT":"0","ESPINSTRUCTION":"","CURRSUBPRODTYPE":"","CURRSETTLEMENTAMNT":"0","CURRREDUCTIONFREQ":"0","CURRREDUCTIONAMNT":"0","CURRONCEOFFREDUCTION":"0","CURRLIMIT":"0","CURRINTRATEPRIMEOFFSET":"0","CURRINSTALMNTFREQ":"0","CURRINSTALLMENT":"0","CURRINITFEEPREVDEBITED":"","CURREXISTEMPOWERMNTFUNDIND":"Y","CURREXISTEMPOWERMNTFUND":"999","CURRENFORCEDREDLIM":"N","CURRBALANCE":"-6109596","CARDTYPE":"","ACCOUNTNUMBER":"1000157283"},"APPPRDSECO":{"SUPPORTINGSPECIFIC":"0","SPECIFIC":"0"},"APPPRDEXST":{"REQTOTALAMNT":"900000","REQTERMOFLOAN":"0","REQSUBPRODTYPE":"","REQREQEMPOWERMNTFUNDIND":"Y","REQREQEMPOWERMNTFUND":"999","REQREPAYMNTOPTION":"0","REQREDUCTIONFREQ":"0","REQREDUCTIONAMNT":"0","REQPRODTYPE":"11019","REQPRODCOMBINATIONNUM":"0","REQPAYMNTMETHOD":"","REQONCEOFFFREQAMNT":"0","REQODLIMITTYPE":"2","REQNUMSKIPPEDPAYMNTS":"0","REQLIMITTYPEIND":"0","REQINSTALLMENTFREQ":"0","REQINITIATIONFEEPAYMNTMETHOD":"D","REQFACILITYTYPE":"0","REQCREDLIFEPREMIUM":"0","REQCAMPAIGNCODE":"","REQADDITIONALAMNT":"0","INITIATIONFEEPAYMNTMETHOD":"","APPLICATIONSTATUS":"P"}},"Entity06":{"INTENTUNDERJUDICIALMNGMNT":"N","INTENTUNDERDEBTCOUNSELLING":"N","INTENTTRID":{},"INTENTRDET":{},"INTENTPARTOFCREDITGROUP":"N","INTENTNUMPARTICIPANTS6":"","INTENTNUMPARTICIPANTS5":"","INTENTNUMPARTICIPANTS4":"","INTENTNUMPARTICIPANTS3":"","INTENTNUMPARTICIPANTS2":"0","INTENTNUMPARTICIPANTS1":"0","INTENTNONRESIDENT":"N","INTENTMARITALSTATUS":"","INTENTMARITALCONTRACT":"","INTENTLMTS":{"OTHEROC":"0","CHEQ":"0","CC":"0"},"INTENTINST":{"TL":"0","OTHEROC":"0","ML":"2136","CC":"0","ASSETFINANCE":"0"},"INTENTINSOLVENT":"N","INTENTHIGHLEVELLIMITINDICATOR":"N","INTENTFINANCIALCRIMEHOLD":"N","INTENTEXPO":{"CONTINGENTLIABILITY":"0","ASSETFINANCE":"0"},"INTENTEXCS":{"OTHEROC":"0","CHEQACCS":"0","CC":"0"},"INTENTCTBALANCECASHCOVER":"0","INTENTCMTM":{"ASSETFINANCE":"0"},"INTENTCLIENTTYPE":"","INTENTCLIENTCODE6":"","INTENTCLIENTCODE5":"","INTENTCLIENTCODE4":"","INTENTCLIENTCODE3":"","INTENTCLIENTCODE2":"ATSET  001","INTENTCLIENTCODE1":"","INTENTCDUCTMAINPYTURNOVER":"0","INTENTBUR":{},"INTENTARRS":{"TL":"0","OTHEROC":"0","ML":"298267","CC":"0","ASSETFINANCE":"0"},"APPENTWORKADDRLINE2":"","APPENTWORKADDRLINE1":"","APPENTTEMPPERMITNUM":"","APPENTSHAREHOLDINGPERC":"","APPENTRESIDENTIALSTATUS":"","APPENTPASSPORTNATIONALITY":"","APPENTINTENTIONTOINSOLVENCY":"Y","APPENTINCOMETAXNUM":"","APPENTIDTYPE":"","APPENTHOMECELLNUM":"","APPENTGROSSINCOME":"0","APPENTGENDER":"","APPENTEXPO":{"APPRFACILITIESODNONSCR":"0","APPRFACILITIESMLNONSCR":"0","APPRFACILITIESAFINNONSCR":"0"},"APPENTEMAIL":"","APPENTBUR":{},"APPENTAPRF":{"INSTORDCREDNONSCORED":"0","INSTMLOANNONSCORED":"0","INSTASSETFINNONSCORED":"0"},"APPENTAPPLCATEGORY":"","APPENTAGE":"0000"},"Entity05":{"INTENTUNDERJUDICIALMNGMNT":"N","INTENTUNDERDEBTCOUNSELLING":"N","INTENTTRID":{},"INTENTRDET":{},"INTENTPARTOFCREDITGROUP":"N","INTENTNUMPARTICIPANTS6":"","INTENTNUMPARTICIPANTS5":"","INTENTNUMPARTICIPANTS4":"","INTENTNUMPARTICIPANTS3":"","INTENTNUMPARTICIPANTS2":"0","INTENTNUMPARTICIPANTS1":"0","INTENTNONRESIDENT":"N","INTENTMARITALSTATUS":"","INTENTMARITALCONTRACT":"","INTENTLMTS":{"OTHEROC":"0","CHEQ":"0","CC":"0"},"INTENTINST":{"TL":"0","OTHEROC":"0","ML":"2136","CC":"0","ASSETFINANCE":"0"},"INTENTINSOLVENT":"N","INTENTHIGHLEVELLIMITINDICATOR":"N","INTENTFINANCIALCRIMEHOLD":"N","INTENTEXPO":{"CONTINGENTLIABILITY":"0","ASSETFINANCE":"0"},"INTENTEXCS":{"OTHEROC":"0","CHEQACCS":"0","CC":"0"},"INTENTCTBALANCECASHCOVER":"0","INTENTCMTM":{"ASSETFINANCE":"0"},"INTENTCLIENTTYPE":"","INTENTCLIENTCODE6":"","INTENTCLIENTCODE5":"","INTENTCLIENTCODE4":"","INTENTCLIENTCODE3":"","INTENTCLIENTCODE2":"PRICING001","INTENTCLIENTCODE1":"","INTENTCDUCTMAINPYTURNOVER":"0","INTENTBUR":{},"INTENTARRS":{"TL":"0","OTHEROC":"0","ML":"298267","CC":"0","ASSETFINANCE":"0"},"APPENTWORKADDRLINE2":"","APPENTWORKADDRLINE1":"","APPENTTEMPPERMITNUM":"","APPENTSHAREHOLDINGPERC":"","APPENTRESIDENTIALSTATUS":"","APPENTPASSPORTNATIONALITY":"","APPENTINTENTIONTOINSOLVENCY":"Y","APPENTINCOMETAXNUM":"","APPENTIDTYPE":"","APPENTHOMECELLNUM":"","APPENTGROSSINCOME":"0","APPENTGENDER":"","APPENTEXPO":{"APPRFACILITIESODNONSCR":"0","APPRFACILITIESMLNONSCR":"0","APPRFACILITIESAFINNONSCR":"0"},"APPENTEMAIL":"","APPENTBUR":{},"APPENTAPRF":{"INSTORDCREDNONSCORED":"0","INSTMLOANNONSCORED":"0","INSTASSETFINNONSCORED":"0"},"APPENTAPPLCATEGORY":"","APPENTAGE":"0000"},"Entity04":{"INTENTUNDERJUDICIALMNGMNT":"N","INTENTUNDERDEBTCOUNSELLING":"N","INTENTTRID":{},"INTENTRDET":{},"INTENTPARTOFCREDITGROUP":"Y","INTENTNUMPARTICIPANTS6":"","INTENTNUMPARTICIPANTS5":"","INTENTNUMPARTICIPANTS4":"","INTENTNUMPARTICIPANTS3":"0","INTENTNUMPARTICIPANTS2":"","INTENTNUMPARTICIPANTS1":"0","INTENTNONRESIDENT":"N","INTENTMARITALSTATUS":"","INTENTMARITALCONTRACT":"","INTENTLMTS":{"OTHEROC":"0","CHEQ":"0","CC":"0"},"INTENTINST":{"TL":"8777","OTHEROC":"0","ML":"2136","CC":"0","ASSETFINANCE":"0"},"INTENTINSOLVENT":"N","INTENTHIGHLEVELLIMITINDICATOR":"N","INTENTFINANCIALCRIMEHOLD":"N","INTENTEXPO":{"CONTINGENTLIABILITY":"0","ASSETFINANCE":"0"},"INTENTEXCS":{"OTHEROC":"0","CHEQACCS":"0","CC":"0"},"INTENTCTBALANCECASHCOVER":"0","INTENTCMTM":{"ASSETFINANCE":"0"},"INTENTCLIENTTYPE":"","INTENTCLIENTCODE6":"","INTENTCLIENTCODE5":"","INTENTCLIENTCODE4":"","INTENTCLIENTCODE3":"VWYK   305","INTENTCLIENTCODE2":"BONTSE 001","INTENTCLIENTCODE1":"","INTENTCDUCTMAINPYTURNOVER":"0","INTENTBUR":{},"INTENTARRS":{"TL":"0","OTHEROC":"0","ML":"298267","CC":"0","ASSETFINANCE":"0"},"APPENTWORKADDRLINE2":"","APPENTWORKADDRLINE1":"","APPENTTEMPPERMITNUM":"","APPENTSHAREHOLDINGPERC":"","APPENTRESIDENTIALSTATUS":"","APPENTPASSPORTNATIONALITY":"","APPENTINTENTIONTOINSOLVENCY":"Y","APPENTINCOMETAXNUM":"","APPENTIDTYPE":"","APPENTHOMECELLNUM":"","APPENTGROSSINCOME":"0","APPENTGENDER":"","APPENTEXPO":{"APPRFACILITIESODNONSCR":"0","APPRFACILITIESMLNONSCR":"0","APPRFACILITIESAFINNONSCR":"0"},"APPENTEMAIL":"","APPENTBUR":{},"APPENTAPRF":{"INSTORDCREDNONSCORED":"0","INSTMLOANNONSCORED":"0","INSTASSETFINNONSCORED":"0"},"APPENTAPPLCATEGORY":"","APPENTAGE":"0000"},"Entity03":{"INTENTWRSTRISKGRADE":"0","INTENTUNDERJUDICIALMNGMNT":"N","INTENTUNDERDEBTCOUNSELLING":"","INTENTTRID":{"TOTSAVRETPAYMNTSL6M":"","TOTCHEQRETPAYMNTSL6M":"","NUMRDEVENTSSAVL6M":"0","NUMRDEVENTSSAVL3M":"0","NUMRDEVENTSCHEQL6M":"0","NUMRDEVENTSCHEQL3M":"0","NUMMNTHSEXCESSBALL6M":"0","NUMDEBITSL6M":"","NUMDAYSDEBITINL6M":"0","NUMDAYSCREDITINL6M":"0","MNTHSOLDESTSAVACCREL":"0","MNTHSOLDESTCUSTREL":"126","MNTHSOLDESTCHACCREL":"0","MNTHSOLDESTACCREL":"0","MAXOCSCORINGMANDATE":"130000","MAXCONSECDAYSINEXCESS":"0","EXPECTEDCREDTURNOVCUST":"0","EXCLUSIONTYPE":"P","EXCLUSIONREASON":"402","EXCLUSIONCREDITFACILITY":"","BEHAVSCOREMORTG":"0","BEHAVSCORELOANS":"0","BEHAVSCORECUSTALIGN":"0","BEHAVSCORECHEQ":"0","BEHAVSCORECC":"0","BEHAVSCOREAVAF":"0","AVGCTOL6ML12M":"0.00","AVGCTOL3ML6M":"0.00","AOL":"0","AMR":"0","AMMR":"0","AMLR":"0","ACCL":"0","ABRA":"0"},"INTENTRDET":{"WRSTCOLLRISKTYPE":"DCO","WRSTARMSHOLD":"","INBUSNRESC":"","EWLLISTING":"2.0","BUSNRESCAFFECTEDPARTY":"N"},"INTENTPARTOFCREDITGROUP":"Y","INTENTNUMPARTICIPANTS6":"","INTENTNUMPARTICIPANTS5":"","INTENTNUMPARTICIPANTS4":"","INTENTNUMPARTICIPANTS3":"0","INTENTNUMPARTICIPANTS2":"0","INTENTNUMPARTICIPANTS1":"0","INTENTNONRESIDENT":"N","INTENTMARITALSTATUS":"2","INTENTMARITALCONTRACT":"","INTENTLMTS":{"OTHEROC":"10000","CHEQ":"0","CC":"5000165"},"INTENTINST":{"TL":"8734","OTHEROC":"658","ML":"2136","CC":"0","ASSETFINANCE":"0"},"INTENTINSOLVENT":"N","INTENTINLIQUIDATION":"N","INTENTHIGHLEVELLIMITINDICATOR":"N","INTENTFRAUDRISKMNGMNT":"Y","INTENTFINANCIALCRIMEHOLD":"N","INTENTEXPO":{"TOTALEXPOSURE":"2141912","TOTALDIRECTEXPOSURE":"2141912","RECOVERYEXPOSURE":"10635","ORDCRED":"994841","MORTGTOTAL":"198234","MORTGRES":"198234","MORTGCPF":"0","MORTGAGRI":"0","CONTINGENTLIABILITY":"0","ASSETFINANCE":"0"},"INTENTEXCS":{"OTHEROC":"5000","CHEQACCS":"809337","CC":"0"},"INTENTCTBALANCETERMDEPOSITS":"272788","INTENTCTBALANCESAVINGS":"234609","INTENTCTBALANCENOTICEDEPOSITS":"19894","INTENTCTBALANCECUSTINVESTMENTS":"0","INTENTCTBALANCECHEQS":"1214760","INTENTCTBALANCECASHCOVER":"0","INTENTCMTM":{"ORDCREDIT":"996378","MORTGTOTAL":"198234","MORTGRES":"198234","MORTGCPF":"0","MORTGAGRI":"0","ASSETFINANCE":"0"},"INTENTCLIENTTYPE":"101","INTENTCLIENTCODE6":"","INTENTCLIENTCODE5":"","INTENTCLIENTCODE4":"","INTENTCLIENTCODE3":"FOURIE 961","INTENTCLIENTCODE2":"FOURIE 910","INTENTCLIENTCODE1":"FOURIBM001","INTENTCDUCTMAINPYTURNOVER":"0","INTENTBUR":{},"INTENTARRS":{"TL":"30556","OTHEROC":"11565","ML":"298267","CC":"0","ASSETFINANCE":"0"},"APPENTWORKADDRPCODE":"2194","APPENTWORKADDRCITY":"RANDBURG","APPENTSHAREHOLDINGPERC":"","APPENTPASSPORTNATIONALITY":"South Africa","APPENTINTENTIONTOINSOLVENCY":"Y","APPENTIDTYPE":"01","APPENTHOMECELLNUM":"123000000","APPENTGENDER":"M","APPENTEXPO":{"SETTLEMENTLIMITS":"3","APPRFACILITIESODNONSCR":"6","APPRFACILITIESMLNONSCR":"6","APPRFACILITIESAFINNONSCR":"3"},"APPENTBUR":{"CONSINPNATID":"7010075121089"},"APPENTAPRF":{"INSTORDCREDNONSCORED":"8","INSTMLOANNONSCORED":"8","INSTASSETFINNONSCORED":"4"},"APPENTAPPLCATEGORY":"","APPENTAGEOLDESTRELATIONSHIP":"126","APPENTAGE":"5000"},"Entity01":{"INTENTWRSTRISKGRADE":"0","INTENTUNDERJUDICIALMNGMNT":"N","INTENTUNDERDEBTCOUNSELLING":"N","INTENTTRID":{"TOTSAVRETPAYMNTSL6M":"","TOTCHEQRETPAYMNTSL6M":"","NUMRDEVENTSSAVL6M":"0","NUMRDEVENTSSAVL3M":"0","NUMRDEVENTSCHEQL6M":"0","NUMRDEVENTSCHEQL3M":"0","NUMMNTHSEXCESSBALL6M":"0","NUMDEBITSL6M":"","NUMDAYSDEBITINL6M":"0","NUMDAYSCREDITINL6M":"0","MNTHSOLDESTSAVACCREL":"0","MNTHSOLDESTCUSTREL":"297","MNTHSOLDESTCHACCREL":"0","MNTHSOLDESTACCREL":"0","MAXOCSCORINGMANDATE":"200000","MAXCONSECDAYSINEXCESS":"0","EXPECTEDCREDTURNOVCUST":"0","EXCLUSIONTYPE":"P","EXCLUSIONREASON":"405","EXCLUSIONCREDITFACILITY":"","BEHAVSCOREMORTG":"0","BEHAVSCORELOANS":"0","BEHAVSCORECUSTALIGN":"0","BEHAVSCORECHEQ":"0","BEHAVSCORECC":"0","BEHAVSCOREAVAF":"0","AVGCTOL6ML12M":"0.00","AVGCTOL3ML6M":"0.00","AOL":"0","AMR":"0","AMMR":"0","AMLR":"0","ACCL":"0","ABRA":"0"},"INTENTRDET":{"WRSTCOLLRISKTYPE":"INS","WRSTARMSHOLD":"BDH","INBUSNRESC":"N","EWLLISTING":"0.0","BUSNRESCAFFECTEDPARTY":"N"},"INTENTPARTOFCREDITGROUP":"","INTENTNUMPARTICIPANTS6":"0","INTENTNUMPARTICIPANTS5":"0","INTENTNUMPARTICIPANTS4":"0","INTENTNUMPARTICIPANTS3":"0","INTENTNUMPARTICIPANTS2":"0","INTENTNUMPARTICIPANTS1":"0","INTENTNONRESIDENT":"N","INTENTMARITALSTATUS":"","INTENTMARITALCONTRACT":"","INTENTLMTS":{"OTHEROC":"0","CHEQ":"0","CC":"0"},"INTENTINST":{"TL":"0","OTHEROC":"0","ML":"2136","CC":"0","ASSETFINANCE":"0"},"INTENTINSOLVENT":"N","INTENTINLIQUIDATION":"N","INTENTHIGHLEVELLIMITINDICATOR":"N","INTENTFRAUDRISKMNGMNT":"N","INTENTFINANCIALCRIMEHOLD":"N","INTENTEXPO":{"TOTALEXPOSURE":"7382297","TOTALDIRECTEXPOSURE":"7382297","RECOVERYEXPOSURE":"0","ORDCRED":"6109597","MORTGTOTAL":"1272700","MORTGRES":"0","MORTGCPF":"0","MORTGAGRI":"1272700","CONTINGENTLIABILITY":"0","ASSETFINANCE":"0"},"INTENTEXCS":{"OTHEROC":"0","CHEQACCS":"6109597","CC":"0"},"INTENTCTBALANCETERMDEPOSITS":"0","INTENTCTBALANCESAVINGS":"0","INTENTCTBALANCENOTICEDEPOSITS":"0","INTENTCTBALANCECUSTINVESTMENTS":"0","INTENTCTBALANCECHEQS":"0","INTENTCTBALANCECASHCOVER":"0","INTENTCMTM":{"ORDCREDIT":"7382297","MORTGTOTAL":"1272700","MORTGRES":"0","MORTGCPF":"0","MORTGAGRI":"1272700","ASSETFINANCE":"0"},"INTENTCLIENTTYPE":"02301","INTENTCLIENTCODE6":"CGTWO  001","INTENTCLIENTCODE5":"CGONE  002","INTENTCLIENTCODE4":"CGONE  001","INTENTCLIENTCODE3":"CGCC   002","INTENTCLIENTCODE2":"BCC    770","INTENTCLIENTCODE1":"SBSOUTP001","INTENTCDUCTMAINPYTURNOVER":"0","INTENTBUR":{},"INTENTARRS":{"TL":"0","OTHEROC":"0","ML":"298267","CC":"0","ASSETFINANCE":"0"},"APPENTWORKADDRLINE2":"","APPENTWORKADDRLINE1":"","APPENTTEMPPERMITNUM":"","APPENTSHAREHOLDINGPERC":"50","APPENTRESIDENTIALSTATUS":"","APPENTPASSPORTNATIONALITY":"","APPENTINTENTIONTOINSOLVENCY":"Y","APPENTINCOMETAXNUM":"","APPENTIDTYPE":"","APPENTHOMECELLNUM":"","APPENTGROSSINCOME":"0","APPENTGENDER":"","APPENTEXPO":{"SETTLEMENTLIMITS":"1","APPRFACILITIESODNONSCR":"2","APPRFACILITIESMLNONSCR":"2","APPRFACILITIESAFINNONSCR":"1"},"APPENTEMAIL":"","APPENTBUR":{},"APPENTAPRF":{"INSTORDCREDNONSCORED":"4","INSTMLOANNONSCORED":"4","INSTASSETFINNONSCORED":"2"},"APPENTAPPLCATEGORY":"","APPENTAGEOLDESTRELATIONSHIP":"297","APPENTAGE":"0000"},"DERPCOUNIQUENUMBER":"000000007620","AppData":{"INTAPPSECE":{"SPECASVALL":"0","SPECASVACCSSETTLE":"0","PERCNORMCHANGED":"N","OUSTANDINGSEC":"N","MASVAGRI":"0","MASV":"0","CESSIONDEBTORS":"N","CASHCOVER":"0","ASVOC":"0","APPRSECVALUE":"0"},"INTAPPNCAP":{"UCTMAXSERVICEFEES":"69","UCTINTERESTRATE":"27.75","UCTINITFEESTHRESHOLD":"1000","UCTINITFEESNEXTPERC":"11.5","UCTINITFEESMAX":"6040.5","UCTINITFEESFIRST":"189.75","STCTMAXSERVICEFEES":"69","STCTINTERESTRATE":"60","STCTINITFEESTHRESHOLD":"1000","STCTINITFEESNEXTPERC":"11.5","STCTINITFEESMAX":"1207.5","STCTINITFEESFIRST":"189.75","REPORATE":"7","PRIMERATE":"6.25","OCAMAXSERVICEFEES":"69","OCAINTERESTRATE":"21","OCAINITFEESTHRESHOLD":"1000","OCAINITFEESNEXTPERC":"11.5","OCAINITFEESMAX":"1207.5","OCAINITFEESFIRST":"189.75","MAMAXSERVICEFEES":"69","MAINTERESTRATE":"19","MAINITFEESTHRESHOLD":"10000","MAINITFEESNEXTPERC":"11.5","MAINITFEESMAX":"6037.5","MAINITFEESFIRST":"1265","CAMAXSERVICEFEES":"69","CAINTERESTRATE":"20.75","CAINITFEESTHRESHOLD":"1000","CAINITFEESNEXTPERC":"11.5","CAINITFEESMAX":"6050.5","CAINITFEESFIRST":"189.75"},"INTAPPEXPO":{},"INTAPPCCLP":{"TLCREDITLIFEMINAMNT":"0","TLCREDITLIFEMAXAMNT":"0","ODCREDITLIFEMINAMNT":"0","ODCREDITLIFEMAXAMNT":"0"},"INTAPPAFFECTEDPERSREG31F":"","INTAPPABSA":{"NUMBEROFPRODUCTS":"5","CHQACCRELATIONSHIP":"S"},"APPAPPSECUREDBYMORTGAGEBOND":"Y","APPAPPSECO":{"SUPPORTINGSPECIFIC":"0","SUPPORTINGNONSPECIFIC":"0","ASVOFFERED":"0","ASVADDOFFERED":"0"},"APPAPPNUMPARTICIPANTS":"","APPAPPNUMKEYPRINCIPALS":"4","APPAPPNUMCOREPRINCIPALS":"4","APPAPPNONRESPRINCIPALS":"0","APPAPPMNTHSSINCEBUSESTABLISHED":"0","APPAPPEXTR":{"TLNACC":"N","SAVAMNT":"0","SAVACC":"N","MLOANAMNT":"0","MLOANACC":"N","INVAMNT":"0","INVACC":"N","CHEQAMNT":"0","CHEQACC":"N","CARDAMNT":"0","CARDACC":"N","ASSETAMNT":"0","ASSETACC":"N"},"APPAPPBSTM":{"TURNOVER":"0","PERIOD":"0","ODLIMITS":"0","NUMRDITEMS":"0","MINBALANCE":"0"}},"APPBANKERNUMBER":"9145944","APPAPPTRADINGINDICATOR":"Y","APPAPPSTOKVELAPPLICATION":"N","APPAPPSTAGEID":"1","APPAPPREQUESTEDFRANCHISORTYPE":"","APPAPPREQUESTEDFRANCHISEFINANCING":"N","APPAPPFORMALAPPINDICATOR":"N","APPAPPFOREIGNCONTROLLEDPERC":"0","APPAPPEXTRTLAMNT":"57000","APPAPPESPINSTRUCTION":"0000004068","APPAPPENTERPRDEVFUNDREQ":"","APPAPPAPPLICATIONTYPE":"O","APPAPPAPPLICATIONTIME":"101751","APPAPPAPPLICATIONSUBSTATUS":"","APPAPPAPPLICATIONSTATUS":"P","APPAPPAPPLICATIONNUMBER":"0","APPAPPAPPLICATIONDATE":"2021-01-27"}}}';
        system.assertNotEquals(request,null);
		PowerCurveUpdateApplication_Req_IB_v1 pcoUpdateRequestBean = (PowerCurveUpdateApplication_Req_IB_v1)Json.deserialize(request, PowerCurveUpdateApplication_Req_IB_v1.class);
		Opportunity opp = [SELECT Id FROM Opportunity LIMIT 1];
		opp = new OpportunitiesSelector().selectByOppId(opp.Id);
        Application__c app = [SELECT Id FROM Application__c LIMIT 1];

		Test.startTest();
		PowerCurveUpdateController3And5.mapPowerCureveUpdateRequest(pcoUpdateRequestBean, opp, app, 3);
        PowerCurveUpdateController3And5.mapPowerCureveUpdateRequest(pcoUpdateRequestBean, opp, app, 5);
		Test.stopTest();
    }
}