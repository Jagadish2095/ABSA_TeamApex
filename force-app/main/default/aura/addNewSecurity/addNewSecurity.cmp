<aura:component  access="global" controller="securitiesOfferedCTRL" implements="lightning:availableForFlowScreens,force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId">

    <aura:handler action="{!c.doInit}" name="init" value="{!this}" />

    <aura:attribute type="Boolean" name="showMoreDetails" default="false" />

    <aura:attribute type="Boolean" name="bondDetails" default="false" />
    <aura:attribute type="Boolean" name="internalInv" default="false" />
    <aura:attribute type="Boolean" name="externalInv" default="false" />
    <aura:attribute type="Boolean" name="lifeNotLink" default="false" />
    <aura:attribute type="Boolean" name="lifeLink" default="false" />
    <aura:attribute type="Boolean" name="surety" default="false" />
    <aura:attribute type="Boolean" name="genPledge" default="false" />
    <aura:attribute type="Boolean" name="cessionDebtors" default="false" />
    <aura:attribute type="Boolean" name="unitTrust" default="false" />
    <aura:attribute type="Boolean" name="demShares" default="false" />
    <aura:attribute type="Boolean" name="fireIns" default="false" />
    <aura:attribute type="Boolean" name="genCess" default="false" />
    <aura:attribute type="Boolean" name="letterUnder" default="false" />
    <aura:attribute type="Boolean" name="excon" default="false" />

    <aura:attribute name="applicationRecordId" type="String" default = "" />
    <aura:attribute name="security" type="Security_Offered__c" default="{ 'sobjectType': 'Security_Offered__c' }"/>
    <aura:attribute name="SelectedProducts" type="List" default=""/>
    <aura:attribute name="SelectedProductsWithAccRefNum" type="List" default=""/>
    <aura:attribute name="rowId" type="String"/>
     <aura:attribute name="existingSecurities" type="List"/>
     <aura:attribute name="getSecuritiesOfferedByAccount" type="List"/>

    <aura:attribute name="data" type="List"/>
    <aura:attribute name="row" type="List"/>
    <aura:attribute name="columns" type="List"/>
    <aura:attribute name="recordId" type="Id" />
    <aura:attribute name="memberId" type="string" />
    <aura:attribute name = 'iASV' type = 'Integer'/>
    <!-- <aura:registerEvent name="sampleCmpEvent" type="c:newSecurityEvt" />-->
    <aura:attribute name="clientName" type="string"/>
    <aura:attribute name="id" type="string"/>
    <aura:attribute name="cif" type="string"/>
    <aura:attribute name="capacity" type="string"/>
    <aura:attribute name="maritalContract" type="string"/>
    <aura:attribute name="maritalStatus" type="string"/>
    <aura:attribute name="contactId" type="string" default=""/>
    <aura:attribute name="AccountId" type="string"/>
     <aura:attribute name="accName" type="string"/>

    <!-- Start of Changes Added by Jason Q 2021/01/25 (W-007807)-->
    <aura:attribute name="hasMemberId" type="Boolean" default="false" />
    <aura:attribute name="isBusiness" type="Boolean" default="true" />
    <aura:attribute name="isMarried" type="Boolean" default="false" />
    <aura:attribute name="isSpinner" type="Boolean" default="false" />
    <aura:attribute name="isFormReadOnly" type="Boolean" default="false" />
    <aura:attribute name="displaySpecificEntity" type="String" default="" />
    <aura:attribute name="isNewFacility" type="Boolean" default="true" />
    <aura:attribute name="errorMessage" type="String" />
    <!-- End of Changes Added by Jason Q 2021/01/25 (W-007807)-->
    <aura:attribute name="eventMessage" type="String"/>
    <aura:attribute name="showPledgeAmount" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="specificSec" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="facInd" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="intFacInd" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="extCessionFacInd" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="facIndNotLink" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="showiAmountCeded" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="showNotLinkCeded" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="intspecificSec" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="notLinkSpecificSec" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="extCessionIsLimited" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="showCessionExtiSpecificSecurity" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="showiUnitTrustsCessionAmt" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="UnitTrustsfacInd" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="UnitTrustsspecificSec" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="selectedOppAppProducts" type="List" default=""/>
    <aura:attribute name="uniqueIdentifiers" type="List" default=""/>
    <aura:attribute name="mandatory" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="mandatoryPLedge" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="iBondsSpecificSec" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="showiSuretyAmt" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="showiCessionAccLimited" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="showiCessionLoanAccAmt" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="showiApprovedSec" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="showiSuretyDateSigned" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="suretyFacInd" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="showiSuretyFacInd" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="showiDebtorsFacInd" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="debtorsFacInd" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="fireSpecificSec" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="firefacInd" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="DemSpecificSec" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="DemfacInd" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="showiDemLimitedCession" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="linkFacInd" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="showiLinkSpecificSec" type="Boolean" default="false"/> <!--Tinashe-->
    <!--added by Manish for W-011371-->
    <aura:attribute name="newExistingSecuritiesOffered" type="List"/> 
    <aura:attribute name="newExistingSecuritiesOfferedColumns" type="List"/>
    <aura:attribute name="selectedAccounts" type="List" />
    <aura:attribute name="selectedAccountIds" type="List" />
    <!--added by Manish for W-011371-->

    <!-- added by Almas  for W-12706 -->
    <aura:attribute name="isOther" type="Boolean" default="false"/>
    <aura:attribute name="isProceed" type="Boolean" default="false"/>

    <!-- Added by Almas for W-12706 -->

    <aura:attribute name="iDemSecRecId" type="string" default=""/>
    <aura:attribute name="iDebtorsSecRecId" type="string" default=""/>
    <aura:attribute name="iPLedgeSecRecId" type="string" default=""/>
    <aura:attribute name="iSuretySecRecId" type="string" default=""/>
    <aura:attribute name="iNotLinkSecRecId" type="string" default=""/>
    <aura:attribute name="iLinkSecRecId" type="string" default=""/>
    <aura:attribute name="iExternalSecRecId" type="string" default=""/>
    <aura:attribute name="iInternalSecRecId" type="string" default=""/>
    <aura:attribute name="iBondSecRecId" type="string" default=""/>
    <aura:attribute name="iUnitSecRecId" type="string" default=""/>
    <aura:attribute name="iFireSecRecId" type="string" default=""/>
    <aura:attribute name="iGeneralSecRecId" type="string" default=""/>
    <aura:attribute name="iLetterSecRecId" type="string" default=""/>
    <aura:attribute name="iExconSecRecId" type="string" default=""/>

    <aura:attribute name="showiGeneralCessionAmt" type="boolean" default="false"/>
    <aura:attribute name="generalMandatory" type="boolean" default="false"/>
    <aura:attribute name="generalSpecificSec" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="generalfacInd" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="letterMandatory" type="boolean" default="false"/>
    <aura:attribute name="letterSpecificSec" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="letterfacInd" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="exconMandatory" type="boolean" default="false"/>
    <aura:attribute name="exconSpecificSec" type="Boolean" default="false"/> <!--Tinashe-->
    <aura:attribute name="exconfacInd" type="String" default=""/> <!--Tinashe-->
    <aura:attribute name="monthlyRentalMandatory" type="boolean" default="false"/>
    <aura:attribute name="executorMandatory" type="boolean" default="false"/>
    <aura:attribute name="extMandatory" type="boolean" default="false"/>
    <aura:attribute name="debtorsMandatory" type="boolean" default="false"/>

    <aura:attribute name="showDematerialisedDetails" type="boolean" default="false"/>
    <aura:attribute name="showUnitTrustDetails" type="boolean" default="false"/>
    <aura:attribute name="showInternalDetails" type="boolean" default="false"/>
    <aura:attribute name="showExternalDetails" type="boolean" default="false"/>
    <aura:attribute name="showNotLinkDetails" type="boolean" default="false"/>
    <aura:attribute name="showLinkDetails" type="boolean" default="false"/>
    <aura:attribute name="showSuretyDetails" type="boolean" default="false"/>
    <aura:attribute name="showPledgeDetails" type="boolean" default="false"/>
    <aura:attribute name="showDebtorsDetails" type="boolean" default="false"/>
    <aura:attribute name="showFireDetails" type="boolean" default="false"/>
    <aura:attribute name="showLetterDetails" type="boolean" default="false"/>
    <aura:attribute name="showExconDetails" type="boolean" default="false"/>
    <aura:attribute name="showBondDetails" type="boolean" default="false"/>
    <aura:attribute name="showGeneralDetails" type="boolean" default="false"/>

    <aura:attribute name="mandatoryNotLink" type="boolean" default="false"/>
    <aura:attribute name="mandatoryDema" type="boolean" default="false"/>
    <aura:attribute name="unittrustMandatory" type="boolean" default="false"/>

    <aura:attribute name="showiLinkAmountCeded" type="boolean" default="false"/>
    <aura:attribute name="newChequeAccounts" type="Map[]" />

    <aura:attribute name="securitiesOfferedData" type="List"/>
    <aura:attribute name="securitiesOfferedcolumns" type="List"/>
    <aura:attribute name="optionsNotEmpty" type="boolean" default="false"/>

    <aura:attribute name="selReference_Account_Number__c" type="string" default=""/>
    <aura:attribute name="selUnique_Identifier__c" type="string" default=""/>

    <aura:attribute name="selectedRows" type="List" access="PRIVATE"/>
    <aura:attribute name="selSet" type="boolean" default="false"/>
    <aura:attribute name="generalOptionValue" type="string" default=""/>

    <aura:attribute name="iDRegNumField" type="string"/>
    <aura:attribute name="iDTypeField" type="string"/>
    <aura:attribute name="clientTypeField" type="string"/>
    <aura:attribute name="capacityField" type="string"/>
    <aura:attribute name="clientCodeField" type="string"/>
    <aura:attribute name="clientNameField" type="string"/>
    <aura:attribute name="maritalContractTypeField" type="string"/>
    <aura:attribute name="maritalStatusField" type="string"/>
    <aura:attribute name="externalEntityLinked" type="Boolean" default = "true"/>

    <lightning:messageChannel type="securitiesMessageChannel__c"
            aura:id="securitiesMessageChannel"/>

    <lightning:workspaceAPI aura:id="workspace" />
  <!--  <aura:handler name="sampleCmpEvent" event="c:newSecurityEvt" action="{!c.doInit}"/>-->
    <div class="slds-m-around_xx-large">

    </div>
    <!-- Spinner -->
    <aura:if isTrue="{!v.isSpinner}">
        <lightning:spinner variant="brand" alternativeText="Busy" />
    </aura:if>

    <!-- Error Message -->
    <aura:if isTrue="{!not(empty(v.errorMessage))}">
        <div class="recordError"><br/>
            <h2 class="slds-section__title" style="color: red">{!v.errorMessage}</h2><br/>
        </div>
    </aura:if>

    <aura:if isTrue="{!v.hasMemberId}">
        <div class="slds-grid slds-wrap slds-gutters_medium">

            <div class="slds-col slds-size_2-of-2">
                <span>
         <!--
                    <h1 class="slds-text-heading_small">Securities for Account {!v.accName}</h1>-->
                    <h1 class="slds-text-heading_small">Add Securities for {!v.clientName} </h1>

                </span>
            </div>
            <br/><br/>
            <div class="slds-col slds-size_1-of-2">
                <span>
                    <h1 class="slds-text-heading_small">Client Name</h1>
                    <h1 class="slds-text-heading_small"> <b>{!v.clientName}</b></h1>
                </span>
            </div>
            <div class="slds-col slds-size_1-of-2">
                <span>
                    <h1 class="slds-text-heading_small">Client Code</h1>
                    <h1 class="slds-text-heading_small"> <b>{!v.cif}</b> </h1>
                </span>
            </div>

            <div class="slds-col slds-size_1-of-2">
                <span>
                    <h1 class="slds-text-heading_small">ID / Registration</h1>
                    <h1 class="slds-text-heading_small"> <b> {!v.id}</b></h1>
                </span>
            </div>

            <div class="slds-col slds-size_1-of-2">
                <span>
                    <h1 class="slds-text-heading_small">Marital Status</h1>
                    <h1 class="slds-text-heading_small"> <b>{!v.maritalStatus}</b> </h1>
                </span>
            </div>
            <div class="slds-col slds-size_1-of-2">
                <span>
                    <h1 class="slds-text-heading_small">Marital Contract</h1>
                    <h1 class="slds-text-heading_small"> <b>{!v.maritalContract} </b></h1>
                </span>
            </div>


        </div>
        <!-- Start of Changes Added by Jason Q 2021/01/25 (W-007807)-->
        <aura:set attribute="else">
            <lightning:recordEditForm   aura:id="newSecurityOfferedForm"
                                        objectApiName="Security_Offered__c"
                                        onsuccess="{!c.handleSuccess}"
                                        onerror="{!c.handleError}"
            >
            <!-- Hidden Fields -->
            <lightning:inputField aura:id="securityTypeField" fieldName="Security_Type__c" class="slds-hide"/>
            <lightning:inputField aura:id="applicationIdField" fieldName="Application__c" class="slds-hide"/>
                <!-- New Security Offered Form -->
                <h2 class="slds-text-heading--medium">New External Entity</h2>
                <lightning:layout multipleRows="true">
                    <lightning:layoutItem padding="around-small" size="2">
                        <lightning:inputField aura:id="clientNameField" fieldName="Client_Name__c" required="true" disabled="{!v.isFormReadOnly}"/>
                    </lightning:layoutItem>
                    <lightning:layoutItem padding="around-small" size="2">
                        <lightning:inputField aura:id="clientCodeField" fieldName="Client_Code__c" required="false" disabled="{!v.isFormReadOnly}"/>
                    </lightning:layoutItem>
                    <lightning:layoutItem padding="around-small" size="2">
                        <lightning:inputField aura:id="capacityField" fieldName="Capacity__c" required="true" disabled="{!v.isFormReadOnly}"/>
                    </lightning:layoutItem>
                    <lightning:layoutItem padding="around-small" size="6"/>
                    <lightning:layoutItem padding="around-small" size="2">
                        <lightning:inputField aura:id="clientTypeField" fieldName="Client_Type__c" onchange="{!c.handleClientTypeChange}" required="true" disabled="{!v.isFormReadOnly}"/>
                    </lightning:layoutItem>
                    <lightning:layoutItem padding="around-small" size="2">
                        <lightning:inputField aura:id="iDTypeField" fieldName="ID_Type__c" required="false" disabled="{!v.isFormReadOnly}"/>
                    </lightning:layoutItem>
                    <lightning:layoutItem padding="around-small" size="2">
                        <lightning:inputField aura:id="iDRegNumField" fieldName="ID_Registration_Number__c" required="false" disabled="{!v.isFormReadOnly}"/>
                    </lightning:layoutItem>
                    <lightning:layoutItem padding="around-small" size="6"/>
                    <lightning:layoutItem padding="around-small" size="3" class="{!if(v.isBusiness, 'slds-hide', '')}">
                        <lightning:inputField aura:id="maritalStatusField" fieldName="MaritalStatus__c" onchange="{!c.handleMaritalStatusChange}" required="{!if(v.isBusiness, 'false', 'true')}" disabled="{!v.isFormReadOnly}"/>
                    </lightning:layoutItem>
                    <lightning:layoutItem padding="around-small" size="3" class="{!if(v.isMarried, '', 'slds-hide')}">
                        <lightning:inputField aura:id="maritalContractTypeField" fieldName="Marital_Contract_Type__c" required="{!if(v.isMarried, 'false', 'true')}" disabled="{!v.isFormReadOnly}"/>
                    </lightning:layoutItem>
                    <lightning:layoutItem padding="around-small" size="6"/>
                    <lightning:layoutItem padding="around-small" size="12">
                        <lightning:button name='Save' label='Save' variant="brand" onclick='{!c.saveNewSecurityOffered}' disabled="{!v.isFormReadOnly}"/>
                    </lightning:layoutItem>
                </lightning:layout>
            </lightning:recordEditForm>
        </aura:set>
        <!-- End of Changes Added by Jason Q 2021/01/25 (W-007807)-->
    </aura:if>

    <div>
        <lightning:accordion aura:id="securitiesOfferedAccordion" allowMultipleSectionsOpen="true" activeSectionName="summaryOffered">
            <lightning:accordionSection name="summaryOffered" label="Summary of Securities Offered">
                <div name="secOfferedDataTable" aura:id="secOfferedDataTable">
                            <lightning:datatable
                            columns="{! v.securitiesOfferedcolumns }"
                            data="{! v.securitiesOfferedData }"
                            keyField="id"
                            onrowaction="{!c.handleRowAction}"
                            onrowselection="{!c.handleRowAction}"
                            hideCheckboxColumn="false"
                            maxRowSelection="1"
                            selectedRows="{! v.selectedRows }"
                            minColumnWidth="100"/>
                </div>
            </lightning:accordionSection>
            <lightning:accordionSection name="newBondSecurity" label="Bonds and 99-year Leasehold">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>Add a Bonds and 99-year Leasehold</b>
                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add Bond" onclick="{!c.addBond}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>
                <br/><br/>
                <aura:if isTrue="{!v.showBondDetails}">
                    <lightning:recordEditForm aura:id="iBondAppRecord" objectApiName="Security_Offered__c" recordId="{!v.iBondSecRecId}" onload="{!c.iBondAppRecordLoad}"
                    onsubmit="{!c.iBondAppRecordSubmit}" onsuccess="{!c.iBondAppRecordSuccess}" onerror="{!c.iBondAppRecordError}" >

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Bonds and 99-year Leasehold #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Bond Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeBondAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iBondAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iBondContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iBondApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iBondSecurityType" value="Bonds and 99-year Leasehold" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <b>Bond Details</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Bond_Ranking__c" aura:id="iRanking" required="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Bond_type__c" aura:id="iType" required="true"/>
                                </span>
                            </div>

                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Bond_holder__c" aura:id="iBondHolder" required="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Bond_registration_number__c" aura:id="iBondRegNo" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Bond_amount_registered_offered__c" aura:id="iAmountReg"  required="true" onchange="{!c.calculateNominalValue}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <b>Property Details</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Property_description__c" aura:id="ipropDescription"  required="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Title_deed_number__c" aura:id="iTitleDeedNo"  required="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Date_registered__c" aura:id="iDateReg"  required="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Property_type__c" aura:id="iPropType"  required="true" onchange="{!c.calculateASVPercent}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <b>Valuation Details</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Valued_by__c" aura:id="iValuedBy"  required="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Realistic_market_value__c" aura:id="iMarketValue"  required="true" onchange="{!c.calculateNominalValue}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Valuation_date__c" aura:id="iValuationDate"  required="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <b>Security Details</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Nominal_Value__c" aura:id="iNominalValue"  required="true" disabled="true"/>  <!-- onchange="{!c.calculateApprovedASV}" -->
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <label for="iASV" class="slds-form-element__label">Approved Security Value Percentage (ASV%)</label>
                                    <lightning:inputField fieldName="Approved_Security_Value_Percentage_ASV__c" aura:id="iASV" variant="label-hidden" required="true" disabled="true" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="ASV_approved_by_Credit__c" aura:id="iASVApprByCR"  onchange="{!c.recalculateASV}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Date_ASV_was_approved_by_Credit__c" aura:id="iASVApprByCRDate"  required="{!v.mandatory}" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Approved_security_value__c" aura:id="iApprovedASV"  required="true" disabled="true" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Specific_Security__c" aura:id="iBondsSpecificSecurity"  required="true" onchange="{!c.oniBondsSpecificSecurityChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.iBondsSpecificSec}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Securities_Offered_for_Facility__c" aura:id="iSecurittOfferedBonds"  required="true" onchange="{!c.displaySpecificEntity}"/>
                                    </span>
                                </div>
                                    <aura:if isTrue="{!v.displaySpecificEntity == 'New'}">
                                        <div class="slds-col slds-size_1-of-2">
                                            <span>
                                                <lightning:select aura:id="iUniqueIdBondsSel" name="select" label="Select Unique Identifier" required="true" onchange="{!c.iUniqueIdBondsOnChange}">
                                                    <option value="">choose one...</option>
                                                    <aura:iteration items="{!v.uniqueIdentifiers}" var="option">
                                                        <aura:if isTrue="{!option.Product_Name__c == 'Cheque'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Overdraft'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Bank Guarantee'}">
                                                        <option text="{!'BG-' + option.Temp_Account_Number__c }" value="{!'BG-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                        </aura:iteration>
                                                </lightning:select>
                                                <lightning:inputField fieldName="Unique_Identifier__c" aura:id="iUniqueIdBonds" class="slds-hide"/>
                                            </span>
                                        </div>
                                    </aura:if>
                                    <aura:if isTrue="{!v.displaySpecificEntity == 'Existing'}">
                                        <div class="slds-col slds-size_1-of-2">
                                            <lightning:select aura:id="iBondsRefAccNo" name="select" label="Select Reference Account Number" required="true" onchange="{!c.iBondsRefAccNoOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.selectedOppAppProducts}" var="option">
                                                    <aura:if isTrue="{!not(empty(option.Account_Number__c))}">
                                                        <option text="{!option.Account_Number__c }" value="{!option.Account_Number__c}"/>
                                                    </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Reference_Account_Number__c" aura:id="iBondReferenceAccNum" class="slds-hide"/>
                                        </div>
                                    </aura:if>
                            </aura:if>
                            <!-- Hidden Fields for background update -->
                            <lightning:inputField fieldName="Realistic_Market_Value_ASV__c" aura:id="iRealMarkValASV" class="slds-hide" /> <!-- onchange="{!c.calculateApprovedASV}" -->
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/> <!-- onclick="{!c.insertNewSecurity}" -->
                                </span>
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="cessionInternalInvestment" label="Cession of Internal Investments ">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>Cession of Internal Investments</b>
                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add Cession of Internal Investments" onclick="{!c.addCessionofInternalInvestments}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>
                <br/><br/>
                <aura:if isTrue="{!v.showInternalDetails}">
                    <lightning:recordEditForm aura:id="iInternalAppRecord" objectApiName="Security_Offered__c"  recordId="{!v.iInternalSecRecId}" onload="{!c.iInternalAppRecordLoad}"
                    onsubmit="{!c.iInternalAppRecordSubmit}" onsuccess="{!c.iInternalAppRecordSuccess}" onerror="{!c.iInternalAppRecordError}" >

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add Cession of Internal Investments #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeInternalAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iInternalAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iInternalContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iInternalApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iInternalSecurityType" value="Cession of Internal Investments" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Limited_Cession__c" aura:id="iInternallimitedCession" required="true" onchange="{!c.oniInternallimitedCessionChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.showiAmountCeded}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Amount_ceded__c" aura:id="iInternalAmountCeded" required="true" onchange="{!c.iInternalAmountCededOnChange}"/>
                                    </span>
                                </div>
                            </aura:if>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Account_number__c" aura:id="iInternalAccNo" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Investment_Type__c" aura:id="iInternalinvType" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Account_balance__c" aura:id="iInternalAccBal" required="true" onchange="{!c.iInternalAccBalOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Available_Amount__c" aura:id="iInternalAvailAmt" required="true" onchange="{!c.iInternalAvailAmtChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Maturity_Date__c" aura:id="iInternalMaturityDate" required="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Nominal_Value__c" aura:id="iInternalNominalValue" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <label for="iApprovedSecValPerc" class="slds-form-element__label">Approved Security Value Percentage (ASV%)</label>
                                    <lightning:inputField fieldName="Approved_Security_Value_Percentage_ASV__c" aura:id="iApprovedSecValPerc" variant="label-hidden" value="100" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Approved_security_value__c" aura:id="iApprovedSecVal" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Specific_Security__c" aura:id="iSpecificSecurity" required="true" onchange="{!c.oniSpecificSecurityChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.intspecificSec}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Securities_Offered_for_Facility__c" aura:id="iSecurityOffered" required="true" onchange="{!c.onintiSecurityOfferedChange}" />
                                    </span>
                                </div>
                                <aura:if isTrue="{!v.intFacInd == 'Existing'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iIntRefAccNo" name="select" label="Select Reference Account Number" required="true" onchange="{!c.iIntRefAccNoOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.selectedOppAppProducts}" var="option">
                                                    <aura:if isTrue="{!not(empty(option.Account_Number__c))}">
                                                        <option text="{!option.Account_Number__c }" value="{!option.Account_Number__c}"/>
                                                    </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Reference_Account_Number__c" aura:id="iInternalRefAccNo" class="slds-hide"/>
                                        </span>
                                    </div>
                                </aura:if>
                                <aura:if isTrue="{!v.intFacInd == 'New'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iInternalUniqueNoSel" name="select" label="Select Unique Identifier" required="true" onchange="{!c.iInternalUniqueNoSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.uniqueIdentifiers}" var="option">
                                                <aura:if isTrue="{!option.Product_Name__c == 'Cheque'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Overdraft'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Bank Guarantee'}">
                                                        <option text="{!'BG-' + option.Temp_Account_Number__c }" value="{!'BG-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Unique_Identifier__c" aura:id="iInternalUniqueNo"  required="true" class="slds-hide" />
                                        </span>
                                    </div>
                                </aura:if>
                            </aura:if>
                                <div class="slds-col slds-size_2-of-2">
                                        <span>
                                            <lightning:button label="Save" type="submit" variant="brand" aura:id=""/> <!-- onclick="{!c.insertInternalCessionSecurity}" -->
                                        </span>
                                    </div>

                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="cessionExternal" label="Cession of External Investments">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>Cession of External Investments</b>
                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>

                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add Cession of External Investments" onclick="{!c.addCessionofExternalInvestments}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>
                <aura:if isTrue="{!v.showExternalDetails}">
                    <lightning:recordEditForm aura:id="iCessionExternalAppRecord" objectApiName="Security_Offered__c"  recordId="{!v.iExternalSecRecId}" onload="{!c.iExternalAppRecordLoad}"
                    onsubmit="{!c.iExternalAppRecordSubmit}" onsuccess="{!c.iExternalAppRecordSuccess}" onerror="{!c.iExternalAppRecordError}" >

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add Cession of External Investments #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeExternalAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iExternalAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iExternalContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iExternalApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iExternalSecurityType" value="Cession of External Investments" required="true" disabled="true"/>
                                </span>
                            </div>
                              <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Investment_holding_Company__c" aura:id="iExtCessionInvestmentHolding"  required="true" onchange="{!c.iextCessionHolderChange}"/>
                               </span>
                            </div>

                            <aura:if isTrue="{!v.isOther}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Investment_Company_Name__c" aura:id="iExtCessionCompanyIssue"  required="true" />
                                    </span>
                                </div>
                            </aura:if>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Limited_Cession__c" aura:id="iExtCessionlimitedCession"  required="true" onchange="{!c.extilimitedCessionChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.extCessionIsLimited}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Amount_ceded__c" aura:id="iExtCessionAmountCeded"  required="true" onchange="{!c.iExtCessionAmountCededOnChange}"/>
                                    </span>
                                </div>
                            </aura:if>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Account_number__c" aura:id="iExtCessionAccNo"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Investment_Type__c" aura:id="iExtCessioninvType"  required="true"  />
                                </span>
                            </div>
                            <!--aura:if isTrue="{!v.extCessionIsLimited}"-->
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Account_balance__c" aura:id="iExtCessionAccBal"  required="true" onchange="{!c.iExtCessionAccBalOnChange}"/>
                                    </span>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Available_Amount__c" aura:id="iExtCessionAvailAmt"  required="true" onchange="{!c.calcExtCessionNominalValue}"/>
                                    </span>
                                </div>
                            <!--/aura:if-->
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Maturity_Date__c" aura:id="iExtCessionMaturityDate"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Nominal_Value__c" aura:id="iExtCessionNominalValue"  required="true" disabled="true"/>
                                </span>
                            </div>
                           <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <label for="iExtCessionASVPerc" class="slds-form-element__label">Approved Security Value Percentage (ASV%)</label>
                                    <lightning:inputField fieldName="Approved_Security_Value_Percentage_ASV__c" aura:id="iExtCessionASVPerc" variant="label-hidden" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="ASV_approved_by_Credit__c" aura:id="iExtCessionASVApprovPerc"  required="false" onchange="{!c.iextCessionASVApprovPercChange}" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Date_ASV_was_approved_by_Credit__c" aura:id="iExtCessionASVDateApprov"  required="{!v.extMandatory}" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Approved_security_value__c" aura:id="iExtCessionASVApprovSecVal" required="false" disabled="true"/>
                                </span>
                            </div>
                           <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Specific_Security__c" aura:id="iExtCessionSpecificSecurity"  required="true" onchange="{!c.iExtCessionSpecificSecurityChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.showCessionExtiSpecificSecurity}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Securities_Offered_for_Facility__c" aura:id="iExtCessionSecurityOffered"  required="true" onchange="{!c.iExtCessionSecurityOfferedChange}"/>
                                    </span>
                                </div>
                                <aura:if isTrue="{!v.extCessionFacInd == 'Existing'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iExtCessionRefAccNoSel" name="select" label="Select Reference Account Number" required="true" onchange="{!c.iExtCessionRefAccNoSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.selectedOppAppProducts}" var="option">
                                                    <aura:if isTrue="{!not(empty(option.Account_Number__c))}">
                                                        <option text="{!option.Account_Number__c }" value="{!option.Account_Number__c}"/>
                                                    </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Reference_Account_Number__c" aura:id="iExtCessionRefAccNo" class="slds-hide" />
                                        </span>
                                    </div>
                                </aura:if>
                                <aura:if isTrue="{!v.extCessionFacInd == 'New'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iExtCessionUniqueIdentifierSel" name="select" label="Select Unique Identifier" required="true" onchange="{!c.iExtCessionUniqueIdentifierSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.uniqueIdentifiers}" var="option">
                                                <aura:if isTrue="{!option.Product_Name__c == 'Cheque'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Overdraft'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Bank Guarantee'}">
                                                        <option text="{!'BG-' + option.Temp_Account_Number__c }" value="{!'BG-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Unique_Identifier__c" aura:id="iExtCessionUniqueIdentifier" class="slds-hide" />
                                        </span>
                                    </div>
                                </aura:if>
                            </aura:if>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/> <!--onclick="{!c.insertExternalCessionSecurity}" -->
                                </span>
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="notLink" label="Cession of Life Policy (Not Link)">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>Cession of Life Policy (Not Link)</b>
                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add Cession of Life Policy (Not Link)" onclick="{!c.addCessionofLifePolicyNotLink}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>

                <aura:if isTrue="{!v.showNotLinkDetails}">
                    <lightning:recordEditForm aura:id="iCessionLifePolicyNotLink" objectApiName="Security_Offered__c"  recordId="{!v.iNotLinkSecRecId}"  onload="{!c.iNotLinkAppRecordLoad}"
                    onsubmit="{!c.iNotLinkAppRecordSubmit}" onsuccess="{!c.iNotLinkAppRecordSuccess}" onerror="{!c.iNotLinkAppRecordError}" >
                    <lightning:messages />
                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add Cession of Life Policy (Not Link) #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeNotLinkAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iNotLinkAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iNotLinkContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iNotLinkApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iNotLinkSecurityType" value="Cession of Life Policy (Not Link)" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Limited_Cession__c" aura:id="iNotLinklimitedCession"  required="true" onchange="{!c.iNotLinklimitedCessionChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.showNotLinkCeded}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Amount_ceded__c" aura:id="iNotLinkAmountCeded" required="true" onchange="{!c.iNotLinkAmountCededOnChange}"/>
                                    </span>
                                </div>
                            </aura:if>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Insurance_company__c" aura:id="iNotLinkInsComp" required="true" disabled="false" onchange="{!c.iNotLinkInsCompChange}" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Policy_number__c" aura:id="iNotLinkPolNo" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Policy_amount__c" aura:id="iNotLinkPolAmt" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Policy_Type__c" aura:id="iNotLinkPolType" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Inception_date__c" aura:id="iNotLinkIncDate" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Free_Surrender_Value_of_policy__c" aura:id="iNotLinkFSV" required="true"  onchange="{!c.iNotLinkFSVChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Date_of_the_Surrender_Value__c" aura:id="iNotLinkSurrenderDate" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Maturity_Date__c" aura:id="iNotLinkMaturitydate"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Name_of_the_assured_life__c" aura:id="iNotLinkNameOfAssured"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="ID_number_of_the_assured_life__c" aura:id="iNotLinkIDNo"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Nominal_Value__c" aura:id="iNotLinkNominalValue"  required="true" disabled="true" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <label for="iNotLinkASVPerc" class="slds-form-element__label">Approved Security Value Percentage (ASV%)</label>
                                    <lightning:inputField fieldName="Approved_Security_Value_Percentage_ASV__c" aura:id="iNotLinkASVPerc" variant="label-hidden" disabled="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="ASV_approved_by_Credit__c" aura:id="iNotLinkASVbyCredit"  required="false" onchange="{!c.iNotLinkASVApprovCreditChange}" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Date_ASV_was_approved_by_Credit__c" aura:id="iNotLinkDateASVbyCredit"  required="{!v.mandatoryNotLink}"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Approved_security_value__c" aura:id="iNotLinkASV"  required="true" disabled="true" />
                                </span>
                            </div>

                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Specific_Security__c" aura:id="iNotLinkSpecificSecurity"  required="true" onchange="{!c.iNotLinkSpecificSecurityChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.notLinkSpecificSec}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Securities_Offered_for_Facility__c" aura:id="iNotLinkSecurittOffered"  required="true" onchange="{!c.iNotLinkSecurittOfferedChange}" />
                                    </span>
                                </div>
                                <aura:if isTrue="{!v.facIndNotLink == 'Existing'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iNotLinkRefAccNoSel" name="select" label="Select Reference Account Number" required="true" onchange="{!c.iNotLinkRefAccNoSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.selectedOppAppProducts}" var="option">
                                                    <aura:if isTrue="{!not(empty(option.Account_Number__c))}">
                                                        <option text="{!option.Account_Number__c}" value="{!option.Account_Number__c}"/>
                                                    </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Reference_Account_Number__c" aura:id="iNotLinkRefAccNo" class="slds-hide"/>
                                        </span>
                                    </div>
                                </aura:if>
                                <aura:if isTrue="{!v.facIndNotLink == 'New'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iNotLinkUniqueNoSel" name="select" label="Select Unique Identifier" required="true" onchange="{!c.iNotLinkUniqueNoSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.uniqueIdentifiers}" var="option">
                                                <aura:if isTrue="{!option.Product_Name__c == 'Cheque'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Overdraft'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Bank Guarantee'}">
                                                        <option text="{!'BG-' + option.Temp_Account_Number__c }" value="{!'BG-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Unique_Identifier__c" aura:id="iNotLinkUniqueNo" class="slds-hide" />
                                        </span>
                                    </div>
                                </aura:if>
                            </aura:if>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/> <!--onclick="{!c.insertCessionOfLifeSecurity}"-->
                                </span>
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="link" label="Cession of Life Policy (Link) (Sanlam)">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>Cession of Life Policy (Link) (Sanlam)</b>
                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add Cession of Life Policy (Link) (Sanlam)" onclick="{!c.addCessionofLifePolicyLinkSanlam}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>
                <aura:if isTrue="{!v.showLinkDetails}">
                    <lightning:recordEditForm aura:id="iLinkAppRecord" objectApiName="Security_Offered__c"  recordId="{!v.iLinkSecRecId}"  onload="{!c.iLinkAppRecordLoad}"
                    onsubmit="{!c.iLinkAppRecordSubmit}" onsuccess="{!c.iLinkAppRecordSuccess}" onerror="{!c.iLinkAppRecordError}" >

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add Cession of Life Policy (Link) (Sanlam) #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeLinkAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iLinkAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iLinkContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iLinkApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iLinkSecurityType" value="Cession of Life Policy (Link) (Sanlam)" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Limited_Cession__c" aura:id="iLinklimitedCession"  required="true" onchange="{!c.iLinklimitedCessionOnChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.showiLinkAmountCeded}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Amount_ceded__c" aura:id="iLinkAmountCeded"  required="true" onchange="{!c.iLinkCalcs}"/>
                                    </span>
                                </div>
                            </aura:if>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Insurance_company__c" aura:id="iLinkInsComp" required="true" value="SANLAM ASSURANCE CO LTD" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Policy_number__c" aura:id="iLinkPolNo" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Policy_amount__c" aura:id="iLinkPolAmt" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Policy_Type__c" aura:id="iLinkPolType" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Inception_date__c" aura:id="iLinkIncDate" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Free_Surrender_Value_of_policy__c" aura:id="iLinkFSV" required="true" onchange="{!c.iLinkCalcs}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Date_of_the_Surrender_Value__c" aura:id="iLinkSurrenderDate" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Maturity_Date__c" aura:id="iLinkMaturitydate"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Name_of_the_assured_life__c" aura:id="iLinkNameOfAssured"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="ID_number_of_the_assured_life__c" aura:id="iLinkIDNo"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Nominal_Value__c" aura:id="iLinkNominalValue"  required="true" disabled="true" onchange="{!c.iLinkCalcs}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <label for="iLinkASV" class="slds-form-element__label">Approved Security Value Percentage (ASV%)</label>
                                    <lightning:inputField fieldName="Approved_Security_Value_Percentage_ASV__c" aura:id="iLinkASV" value="100" disabled="true" variant="label-hidden" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Approved_security_value__c" aura:id="iLinkApprovedValue"  required="true" disabled="true"/>
                                </span>
                            </div>

                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Specific_Security__c" aura:id="iLinkSpecificSecurity"  required="true" onchange="{!c.iLinkSpecificSecurityOnChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.showiLinkSpecificSec}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Securities_Offered_for_Facility__c" aura:id="iLinkSecurityOffered"  required="true" onchange="{!c.iLinkOfferedChange}"/>
                                    </span>
                                </div>
                                <aura:if isTrue="{!v.linkFacInd == 'Existing'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="selectLinkRefAccNum" name="select" label="Select Reference Account Number" required="true" onchange="{!c.iLinkRefAccNoSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.selectedOppAppProducts}" var="option">
                                                    <aura:if isTrue="{!not(empty(option.Account_Number__c))}">
                                                        <option text="{!option.Account_Number__c }" value="{!option.Account_Number__c}"/>
                                                    </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Reference_Account_Number__c" aura:id="iLinkRefAccNo" class="slds-hide" />
                                        </span>
                                    </div>
                                </aura:if>
                                <aura:if isTrue="{!v.linkFacInd == 'New'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iLinkUniqueIdentifierSel" name="select" label="Select Unique Identifier" required="true" onchange="{!c.iLinkUniqueNoSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.uniqueIdentifiers}" var="option">
                                                <aura:if isTrue="{!option.Product_Name__c == 'Cheque'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Overdraft'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Bank Guarantee'}">
                                                        <option text="{!'BG-' + option.Temp_Account_Number__c }" value="{!'BG-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Unique_Identifier__c" aura:id="iLinkUniqueIdentifier" class="slds-hide" />
                                        </span>
                                    </div>
                                </aura:if>
                            </aura:if>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/> <!--onclick="{!c.insertCessionofLifePolicyLink}"-->
                                </span>
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="suretyShip" label="Suretyship">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>Suretyship</b>
                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add Suretyship" onclick="{!c.addSuretyship}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>
                <aura:if isTrue="{!v.showSuretyDetails}">
                    <lightning:recordEditForm aura:id="iSuretyAppRecord" objectApiName="Security_Offered__c"  recordId="{!v.iSuretySecRecId}"  onload="{!c.iSuretyAppRecordLoad}"
                    onsubmit="{!c.iSuretyAppRecordSubmit}" onsuccess="{!c.iSuretyAppRecordSuccess}" onerror="{!c.iSuretyAppRecordError}" >

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add Suretyship #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeSuretyAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iSuretyAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iSuretyContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iSuretyApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iSuretySecurityType" value="Suretyship" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Limited_Cession__c" aura:id="iSuretylimitedCession"  required="true"  onchange="{!c.iSuretylimitedCessionOnChange}"/>
                                </span>
                            </div>
                            <!-- updated required=false by Manish for W-011372 -->
                            <aura:if isTrue="{!v.showiSuretyAmt}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Security_Amount__c"  aura:id="iSuretyAmt"  required="false"/>
                                    </span>
                                </div>
                            </aura:if>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Cession_of_Loan_Account_included__c" aura:id="iCessionLoanAcc" required="true"  onchange="{!c.iCessionLoanAccOnChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.showiCessionAccLimited}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Cession_of_Loan_Account_limited__c" aura:id="iCessionAccLimited" required="true" onchange="{!c.iCessionAccLimitedOnChange}"/>
                                    </span>
                                </div>
                            </aura:if>
                            <aura:if isTrue="{!v.showiCessionLoanAccAmt}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Cession_of_Loan_Account_Limited_Amount__c" aura:id="iCessionLoanAccAmt" required="true"  />
                                    </span>
                                </div>
                            </aura:if>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Supported_by_security__c" aura:id="iSupportedBySec" required="true" onchange="{!c.iSupportedBySecOnChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.showiApprovedSec}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Approved_Security__c" aura:id="iApprovedSec" required="true" onchange="{!c.iApprovedSecOnChange}"/>
                                    </span>
                                </div>
                            </aura:if>
                            <aura:if isTrue="{!v.showiSuretyDateSigned}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Date_Signed__c" aura:id="iSuretyDateSigned" required="true"/>
                                    </span>
                                </div>
                            </aura:if>
                            <aura:if isTrue="{!v.showiSuretyAmt}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Specific_Security__c" aura:id="iSuretySpecificSec"  required="true" onchange="{!c.iSuretySpecificSecOnChange}"/>
                                    </span>
                                </div>
                            </aura:if>
                            <!--added by Manish for W-011371-->

                            <aura:if isTrue="{!v.showiSuretyFacInd}">
                                <lightning:datatable
                                                     keyField="Id"
                                                     data="{! v.newExistingSecuritiesOffered }"
                                                     columns="{! v.newExistingSecuritiesOfferedColumns }"
                                                     onrowselection="{! c.getSelectedAccounts }"
                                                     selectedRows="{! v.selectedAccountIds }"/>

                             </aura:if>
                             <lightning:inputField fieldName="Suretyship_Selected_Accounts__c" aura:id="iSuretyAccs" class="slds-hide" />
                            <!--changes end -->
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/> <!--onclick="{!c.insertSuretyship}"-->
                                </span>
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="pledge" label="General Pledge">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>General Pledge</b>

                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add General Pledge" onclick="{!c.addGeneralPledge}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>
                <aura:if isTrue="{!v.showPledgeDetails}">
                    <lightning:recordEditForm aura:id="iPledgeAppRecord"
                                                objectApiName="Security_Offered__c"
                                                recordId="{!v.iPLedgeSecRecId}"  onload="{!c.iPLedgeAppRecordLoad}"
                                                onsubmit="{!c.iPLedgeAppRecordSubmit}" onsuccess="{!c.iPLedgeAppRecordSuccess}" onerror="{!c.iPLedgeAppRecordError}"
                                                 >

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add General Pledge #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closePledgeAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iPLedgeAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iPLedgeContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iPLedgeApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iDemSecurityType" value="General Pledge" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Asset_covered_by_pledge__c" aura:id="iAssetCovered" required="true"  />
                                </span>
                            </div>

                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Issuing_Company__c" aura:id="iIssuingComp" required="true"  />
                                </span>
                            </div>

                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Asset_reference_number__c" aura:id="iAssetRefNo" required="false"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Limited_pledge__c" aura:id="iLimitedPledge" required="true" onchange="{!c.onLimitedPledgeChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.showPledgeAmount}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Pledge_amount__c" aura:id="iPledgeAmt" required="true"  onchange="{!c.pledgeCals}"/>
                                    </span>
                                </div>
                            </aura:if>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Maturity_Date__c" aura:id="iMaturityDate"  required="false"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Realistic_market_value__c" aura:id="iPledgeRealisticMarketVal" required="true" onchange="{!c.pledgeCals}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Valuation_date__c" aura:id="iValuationDate"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Valuer_name__c" aura:id="iValuerName"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Valuer_address__c" aura:id="iValuerAddress" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Valuer_telephone_number__c" aura:id="iValuerPhone"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Nominal_Value__c" aura:id="iPledgeNominalValue" required="false" disabled="true" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <label for="iPLedgeASVPerc" class="slds-form-element__label">Approved Security Value Percentage (ASV%)</label>
                                    <lightning:inputField fieldName="Approved_Security_Value_Percentage_ASV__c" aura:id="iPLedgeASVPerc" variant="label-hidden" value="0" disabled="true" onchange="{!c.pledgeCals}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="ASV_approved_by_Credit__c" aura:id="iPLedgeASVApprovedCr" required="false" onchange="{!c.iPLedgeASVApprovedCrOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Date_ASV_was_approved_by_Credit__c" aura:id="iPledgeDateASVApprovedCr" required="{!v.mandatoryPLedge}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Approved_security_value__c" aura:id="iPLedgeApprovedSecurityValueASV" disabled="true" required="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Specific_Security__c" aura:id="iPLedgeSpecificSec" required="true" onchange="{!c.oniPLedgeSpecificSecChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.specificSec}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Securities_Offered_for_Facility__c" aura:id="iPLedgeSecOfferedForfac" required="true" onchange="{!c.oniPLedgefacIndChange}"/>
                                    </span>
                                </div>
                                <aura:if isTrue="{!v.facInd == 'Existing'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iPledgeReferenceAccNumSel" name="select" required="true" label="Select Reference Account Number" onchange="{!c.iPledgeReferenceAccNumSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.selectedOppAppProducts}" var="option">
                                                    <aura:if isTrue="{!not(empty(option.Account_Number__c))}">
                                                        <option text="{!option.Account_Number__c}" value="{!option.Account_Number__c}" />
                                                    </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Reference_Account_Number__c" aura:id="iPLedgeReferenceAccNum" class="slds-hide"  />
                                        </span>
                                    </div>
                                </aura:if>
                                <aura:if isTrue="{!v.facInd == 'New'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iPledgeUniqueIdentifierSel" name="select" required="true" label="Select Unique Identifier" onchange="{!c.iPLedgeUniqueIdentifierSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.uniqueIdentifiers}" var="option">
                                                <aura:if isTrue="{!option.Product_Name__c == 'Cheque'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Overdraft'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Bank Guarantee'}">
                                                        <option text="{!'BG-' + option.Temp_Account_Number__c }" value="{!'BG-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Unique_Identifier__c" aura:id="iPledgeUniqueIdentifier"  class="slds-hide"/>
                                        </span>
                                    </div>
                                </aura:if>
                            </aura:if>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/><!--onclick="{!c.insertGeneralPledge}"-->
                                </span>
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="debtors" label="Cession of Debtors">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>Cession of Debtors</b>
                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add Cession of Debtors" onclick="{!c.addCessionofDebtors}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>
                <aura:if isTrue="{!v.showDebtorsDetails}">
                    <lightning:recordEditForm aura:id="iDebtorsSecRecord" objectApiName="Security_Offered__c" recordId="{!v.iDebtorsSecRecId}"  onload="{!c.iDebtorsAppRecordLoad}"
                    onsubmit="{!c.iDebtorsAppRecordSubmit}" onsuccess="{!c.iDebtorsAppRecordSuccess}" onerror="{!c.iDebtorsAppRecordError}" >

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add Cession of Debtors #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeDebtorsAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iDebtorsAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iDebtorsContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iDebtorsApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iDebtorsSecurityType" value="Cession of Debtors" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Nominal_Value__c" aura:id="iDebtorsNominalValue" required="true" onchange="{!c.iDebtorsNominalValueOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <label for="iDebtorsASV" class="slds-form-element__label">Approved Security Value Percentage (ASV%)</label>
                                    <lightning:inputField fieldName="Approved_Security_Value_Percentage_ASV__c" aura:id="iDebtorsASV" variant="label-hidden" value="0" disabled="false" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="ASV_approved_by_Credit__c" aura:id="iDebtorsASVApprovedbyCr" required="false" onchange="{!c.iDebtorsASVApprovedbyCrOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Date_ASV_was_approved_by_Credit__c" aura:id="idateASVApprovedbyCr" required="{!v.debtorsMandatory}"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Approved_security_value__c" aura:id="iDebtorsApprovedASV" required="true" disabled="true" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Specific_Security__c" aura:id="iDebtorsSpecificSecurity" required="true" onchange="{!c.iDebtorsSpecificSecurityOnChange}" />
                                </span>
                            </div>
                            <aura:if isTrue="{!v.showiDebtorsFacInd}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Securities_Offered_for_Facility__c" aura:id="iDebtorsSecOfferedForfac"  required="true" onchange="{!c.iDebtorsSecOfferedForfacOnChange}"/>
                                    </span>
                                </div>
                                <aura:if isTrue="{!v.debtorsFacInd == 'Existing'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iDebtorsRefAccNoSel" name="select" label="Select Reference Account Number" required="true" onchange="{!c.iDebtorsRefAccNoSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.selectedOppAppProducts}" var="option">
                                                    <aura:if isTrue="{!not(empty(option.Account_Number__c))}">
                                                        <option text="{!option.Account_Number__c}" value="{!option.Account_Number__c}"/>
                                                    </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Reference_Account_Number__c" aura:id="iDebtorsRefAccNo"  required="true" class="slds-hide"/>
                                        </span>
                                    </div>
                                </aura:if>
                                <aura:if isTrue="{!v.debtorsFacInd == 'New'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iDebtorsUniqueIdentifierSel" name="select" label="Select Unique Identifier" required="true" onchange="{!c.iDebtorsUniqueIdentifierSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.uniqueIdentifiers}" var="option">
                                                <aura:if isTrue="{!option.Product_Name__c == 'Cheque'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Overdraft'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Bank Guarantee'}">
                                                        <option text="{!'BG-' + option.Temp_Account_Number__c }" value="{!'BG-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Unique_Identifier__c" aura:id="iDebtorsUniqueIdentifier"  required="true" class="slds-hide" />
                                        </span>
                                    </div>
                                </aura:if>
                            </aura:if>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/><!--onclick="{!c.insertCessionofDebtors}"-->
                                </span>
                            </div>

                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="unitTrusts" label="Cession of Unit Trusts">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>Cession of Unit Trusts</b>

                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add Cession of Unit Trusts" onclick="{!c.addCessionofUnitTrusts}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>
                <aura:if isTrue="{!v.showUnitTrustDetails}">
                    <lightning:recordEditForm aura:id="iUnitAppRecord" objectApiName="Security_Offered__c" recordId="{!v.iUnitSecRecId}" onload="{!c.iUnitAppRecordLoad}"
                    onsubmit="{!c.iUnitAppRecordSubmit}" onsuccess="{!c.iUnitAppRecordSuccess}" onerror="{!c.iUnitAppRecordError}" >

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add Cession of Unit Trusts #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeUnitAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iUnitAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iUnitContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iUnitApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iUnitSecurityType" value="Cession of Unit Trusts" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Stockbroker_Name_CSD_Participant__c" aura:id="iStockbrokerName"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Unit_Trust_Name__c" aura:id="iUnitTrustName"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Number_of_unts__c" aura:id="iNumberofUnits"  required="true" onchange="{!c.iNumberofUnitsOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Certificate_number__c" aura:id="iCertNo"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Limited_Cession__c" aura:id="iUnitTrustsLimitedCession"  required="true" onchange="{!c.iUnitTrustsLimitedCessionChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.showiUnitTrustsCessionAmt}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Cession_Amount__c" aura:id="iUnitTrustsCessionAmt"  required="true" onchange="{!c.iUnitTrustsCessionAmtOnChange}"/>
                                    </span>
                                </div>
                            </aura:if>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Redemption_form_held__c" aura:id="iRedemptionFOrmHeld"  required="true" onchange="{!c.iRedemptionFormHeldChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Unit_value__c" aura:id="iUnitVal"  required="true" onchange="{!c.calcUnitTrustsNominalValue}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Nominal_Value__c" aura:id="iUnitTrustsNominalValue"  required="true" disabled="true" onchange="{!c.iUnitTrustsNominalValueOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <label for="iUnitTrustsASVPerc" class="slds-form-element__label">Approved Security Value Percentage (ASV%)</label>
                                    <lightning:inputField fieldName="Approved_Security_Value_Percentage_ASV__c" aura:id="iUnitTrustsASVPerc" variant="label-hidden" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="ASV_approved_by_Credit__c" aura:id="iUnitTrustsASVCr"  required="false" onchange="{!c.iUnitTrustsASVCrChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Date_ASV_was_approved_by_Credit__c" aura:id="iDateASVApprovCr"  required="{!v.unittrustMandatory}" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Approved_security_value__c" aura:id="iUnitTrustsApprovedSecValue"  required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Specific_Security__c" aura:id="iUnitTrustsSpecificSecurity"  required="true" onchange="{!c.iUnitTrustsSpecificSecurityChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.UnitTrustsspecificSec}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Securities_Offered_for_Facility__c" aura:id="iUnitTrustsSecOfferedForfac"  required="true" onchange="{!c.iUnitTrustsSecOfferedForfacChange}"/>
                                    </span>
                                </div>
                                <aura:if isTrue="{!v.UnitTrustsfacInd == 'Existing'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iUnitTrustsReferenceAccNumSel" name="select" label="Select Reference Account Number" required="true" onchange="{!c.iUnitTrustsReferenceAccNumSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.selectedOppAppProducts}" var="option">
                                                    <aura:if isTrue="{!not(empty(option.Account_Number__c))}">
                                                        <option text="{!option.Account_Number__c}" value="{!option.Account_Number__c}"/>
                                                    </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Reference_Account_Number__c" aura:id="iUnitTrustsReferenceAccNum"  class="slds-hide"  />
                                        </span>
                                    </div>
                                </aura:if>
                                <aura:if isTrue="{!v.UnitTrustsfacInd == 'New'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iUnitTrustsUniqueIdentifierSel" name="select" label="Select Unique Identifier" required="true" onchange="{!c.iUnitTrustsUniqueIdentifierSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.uniqueIdentifiers}" var="option">
                                                <aura:if isTrue="{!option.Product_Name__c == 'Cheque'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Overdraft'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Bank Guarantee'}">
                                                        <option text="{!'BG-' + option.Temp_Account_Number__c }" value="{!'BG-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Unique_Identifier__c" aura:id="iUnitTrustsUniqueIdentifier"  class="slds-hide"  />
                                        </span>
                                    </div>
                                </aura:if>
                            </aura:if>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/> <!--onclick="{!c.insertCessionofUnitTrusts}" -->
                                </span>
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="dematerialised" label="Cession of Dematerialised Shares">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>Cession of Dematerialised Shares</b>

                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add Cession of Dematerialised Shares" onclick="{!c.addCessionofDematerialisedShares}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>
                <aura:if isTrue="{!v.showDematerialisedDetails}">
                    <lightning:recordEditForm aura:id="iDemAppRecord" objectApiName="Security_Offered__c" recordId="{!v.iDemSecRecId}" onload="{!c.iDemAppRecordLoad}"
                                            onsubmit="{!c.iDemAppRecordSubmit}" onsuccess="{!c.iDemAppRecordSuccess}" onerror="{!c.iDemAppRecordError}">

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add Cession of Dematerialised Shares #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeDemaAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iDemAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iDemContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iDemApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iDemSecurityType" value="Cession of Dematerialised Shares" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Stockbroker_Name_CSD_Participant__c" aura:id="iDemStockBrokerName"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Share_Name__c" aura:id="iDemShareName"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Account_number__c" aura:id="iDemAccNo"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Number_of_Shares__c" aura:id="iDemNoOfShares"  required="true" onchange="{!c.iDemNoOfSharesOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Transfer_Deed_held__c" aura:id="iDemTransferDeed"  required="true" onchange="{!c.iDemTransferDeedOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Limited_Cession__c" aura:id="iDemLimitedCession"  required="true" onchange="{!c.iDemLimitedCessionOnChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.showiDemLimitedCession}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Cession_Amount__c" aura:id="iDemCessionAmt"  required="true" onchange="{!c.iDemCessionAmtOnChange}"/>
                                    </span>
                                </div>
                            </aura:if>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Unit_value__c" aura:id="iDemUnitVal"  required="true" onchange="{!c.iDemUnitValOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Nominal_Value__c" aura:id="iDemNominalVal" required="true" disabled="true" onchange="{!c.iDemNominalValOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <label for="iDemASVPerc" class="slds-form-element__label">Approved Security Value Percentage (ASV%)</label>
                                    <lightning:inputField fieldName="Approved_Security_Value_Percentage_ASV__c" aura:id="iDemASVPerc" disabled="true" variant="label-hidden" required="true" onchange="{!c.iDemASVPercOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="ASV_approved_by_Credit__c" aura:id="iDemASVCr"  required="false" onchange="{!c.iDemASVCrOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Date_ASV_was_approved_by_Credit__c" aura:id="iDemDateASVApprovCr" required="{!v.mandatoryDema}" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Approved_security_value__c" aura:id="iDemApprovedSecValue"  required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Specific_Security__c" aura:id="iDemSpecificSecurity"  required="true" onchange="{!c.iDemSpecificSecurityOnChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.DemSpecificSec}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Securities_Offered_for_Facility__c" aura:id="iDemSecOfferedForfac"  required="true" onchange="{!c.iDemSecOfferedForfacOnChange}"/>
                                    </span>
                                </div>
                                <aura:if isTrue="{!v.DemfacInd == 'Existing'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iDemReferenceAccNumSel" name="select" required="true" label="Select Reference Account Number" onchange="{!c.iDemReferenceAccNumSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.selectedOppAppProducts}" var="option">
                                                    <aura:if isTrue="{!not(empty(option.Account_Number__c))}">
                                                        <option text="{!option.Account_Number__c}" value="{!option.Account_Number__c}"/>
                                                    </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Reference_Account_Number__c" aura:id="iDemReferenceAccNum" class="slds-hide"/>
                                        </span>
                                    </div>
                                </aura:if>
                                <aura:if isTrue="{!v.DemfacInd == 'New'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iDemUniqueIdentifierSel" name="select" required="true" label="Select Unique Identifier" onchange="{!c.iDemUniqueIdentifierSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.uniqueIdentifiers}" var="option">
                                                <aura:if isTrue="{!option.Product_Name__c == 'Cheque'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Overdraft'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Bank Guarantee'}">
                                                        <option text="{!'BG-' + option.Temp_Account_Number__c }" value="{!'BG-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Unique_Identifier__c" aura:id="iDemUniqueIdentifier" class="slds-hide"/>
                                        </span>
                                    </div>
                                </aura:if>
                            </aura:if>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/><!-- onclick="{!c.insertCessionofDematerialisedShares}"/-->
                                </span>
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="fire" label="Cession of Fire/Short Term Insurance">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>Cession of Fire/Short Term Insurance</b>

                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add Cession of Fire/Short Term Insurance" onclick="{!c.addCessionofFireShortTermInsurance}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>

                <aura:if isTrue="{!v.showFireDetails}">
                    <lightning:recordEditForm aura:id="iFireAppRecord" objectApiName="Security_Offered__c" recordId="{!v.iFireSecRecId}"  onload="{!c.iFireAppRecordLoad}"
                                            onsubmit="{!c.iFireAppRecordSubmit}" onsuccess="{!c.iFireAppRecordSuccess}" onerror="{!c.iFireAppRecordError}">

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add Cession of Fire/Short Term Insurance #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeFireAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iFireAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iFireContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iFireApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iFireSecurityType" value="Cession of Fire/Short Term Insurance" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Insurance_company__c" aura:id="iFireInsuranceCompany"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Policy_number__c" aura:id="iFirePolicyNo"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Policy_amount__c" aura:id="iFirePolicyAmt"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:select aura:id="iFirePolicyTypeSel" name="policyType" label="Policy Type" onchange="{!c.iFirePolicyTypeSelOnChange}">
                                        <option value="">choose one...</option>
                                        <option text="1 - FIRE POLICY" value="1 - FIRE POLICY"/>
                                        <option text="2 - SASRIA" value="2 - SASRIA"/>
                                        <option text="3 - GENERAL" value="3 - GENERAL"/>
                                        <option text="4 - OTHER" value="4 - OTHER"/>
                                        <option text="5 - CROP INSURANCE (AGRI)" value="5 - CROP INSURANCE (AGRI)"/>
                                        <option text="10 - BODY CORPORATE H.O.C. NOTING" value="10 - BODY CORPORATE H.O.C. NOTING"/>
                                    </lightning:select>
                                    <lightning:inputField fieldName="Policy_Type__c" aura:id="iFirePolicyType"  class="slds-hide"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Maturity_Date__c" aura:id="iFireMaturityDate"  required="false"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Renewal_date__c" aura:id="iFireRenewalDate"  required="false"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Specific_Security__c" aura:id="iFireSpecificSecurity"  required="true" onchange="{!c.iFireSpecificSecurityOnChange}"/>
                                </span>
                            </div>

                            <aura:if isTrue="{!v.fireSpecificSec}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Securities_Offered_for_Facility__c" aura:id="iFireSecOfferedForfac"  required="true" onchange="{!c.iFireSecOfferedForfacOnChange}"/>
                                    </span>
                                </div>
                                <aura:if isTrue="{!v.firefacInd == 'Existing'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iFireReferenceAccNumSel" name="select" label="Select Reference Account Number" required="true" onChange="{!c.iFireReferenceAccNumSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.selectedOppAppProducts}" var="option">
                                                    <aura:if isTrue="{!not(empty(option.Account_Number__c))}">
                                                        <option text="{!option.Account_Number__c}" value="{!option.Account_Number__c}" selected="{!v.security.Reference_Account_Number__c}"/>
                                                    </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Reference_Account_Number__c" aura:id="iFireReferenceAccNum"  class="slds-hide"  />
                                        </span>
                                    </div>
                                </aura:if>
                                <aura:if isTrue="{!v.firefacInd == 'New'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iFireUniqueIdentifierSel" name="select" required="true" label="Select Unique Identifier" onchange="{!c.iFireUniqueIdentifierSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.uniqueIdentifiers}" var="option">
                                                <aura:if isTrue="{!option.Product_Name__c == 'Cheque'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Overdraft'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Bank Guarantee'}">
                                                        <option text="{!'BG-' + option.Temp_Account_Number__c }" value="{!'BG-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Unique_Identifier__c" aura:id="iFireUniqueIdentifier"  class="slds-hide"  />
                                        </span>
                                    </div>
                                </aura:if>
                            </aura:if>

                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/> <!--onclick="{!c.insertCessionofFireShortTermInsurance}"-->
                                </span>
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="genCession" label="General Cession">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>General Cession</b>

                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add General Cession" onclick="{!c.addGeneralCession}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>
                <aura:if isTrue="{!v.showGeneralDetails}">

                    <lightning:recordEditForm aura:id="iGeneralAppRecord" objectApiName="Security_Offered__c" recordId="{!v.iGeneralSecRecId}" onload="{!c.iGeneralAppRecordLoad}"
                    onsubmit="{!c.iGeneralAppRecordSubmit}" onsuccess="{!c.iGeneralAppRecordSuccess}" onerror="{!c.iGeneralAppRecordError}">

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add General Cession #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeGeneralAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iGeneralAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iGeneralContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iGeneralApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iGeneralSecurityType" value="General Cession" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Cession_type__c" aura:id="iGeneralCessionType" required="true" onchange="{!c.iGeneralCessionTypeOnChange}"/>
                                </span>
                            </div>
                            <aura:if istrue="{!v.monthlyRentalMandatory}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Monthly_rental_income__c" aura:id="iMonthlyRental" required="true"  />
                                    </span>
                                </div>
                            </aura:if>
                            <aura:if isTrue="{!v.executorMandatory}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Executor__c" aura:id="iExecutor" required="true"/>
                                    </span>
                                </div>
                            </aura:if>
                            <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Limited_Cession__c" aura:id="iGeneralLimitedCession" required="true" onchange="{!c.iGeneralLimitedCessionOnChange}"/>
                                    </span>
                                </div>
                            <aura:if isTrue="{!v.showiGeneralCessionAmt}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Cession_Amount__c" aura:id="iGeneralCessionAmt" required="true" onchange="{!c.generalCalcs}"/>
                                    </span>
                                </div>
                            </aura:if>

                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Account_Reference_Number_of_Cession__c" aura:id="iGenRefAccNo" required="false"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Realistic_market_value__c" aura:id="iGeneralRealisticMarketVal"  required="true" onchange="{!c.generalCalcs}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Valuation_date__c" aura:id="iValuationDate"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Maturity_Date__c" aura:id="iMaturityDate"  required="true"  />
                                </span>
                            </div>

                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Nominal_Value__c" aura:id="iGeneralNominalVal"  required="true" disabled="true" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <label for="iGeneralASVPerc" class="slds-form-element__label">Approved Security Value Percentage (ASV%)</label>
                                    <lightning:inputField fieldName="Approved_Security_Value_Percentage_ASV__c" aura:id="iGeneralASVPerc" variant="label-hidden" disabled="true" value="0"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="ASV_approved_by_Credit__c" aura:id="iGeneralASVCr" required="false" onchange="{!c.iGeneralASVCrOnChange}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Date_ASV_was_approved_by_Credit__c" aura:id="iGeneralDateASVApprovCr" required="{!v.generalMandatory}" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Approved_security_value__c" aura:id="iGeneralApprovedSecValue" required="true" disabled="true" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Specific_Security__c" aura:id="iGeneralSpecificSecurity" onchange="{!c.iGeneralSpecificSecurityOnChange}"/>
                                </span>
                            </div>

                             <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Proceeds_of__c" aura:id="iGeneralProceedValue" required="true"  onchange="{!c.iGeneralproceedOfChange}" />
                                </span>
                            </div>
                            <aura:if isTrue="{!v.isProceed}">
                             <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Account_number__c" aura:id="iGeneralAccountNumber" required="true"  />
                                </span>
                            </div>

                             <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Issuing_Company__c" aura:id="iGeneralCompany" required="true"  />
                                </span>
                            </div>
                            </aura:if> 
                            <aura:if isTrue="{!v.generalSpecificSec}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Securities_Offered_for_Facility__c" aura:id="iGeneralSecOfferedForfac"  required="true" onchange="{!c.iGeneralSecOfferedForfacOnChange}"/>
                                    </span>
                                </div>

                                <aura:if isTrue="{!v.generalfacInd == 'Existing'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:inputField fieldName="Reference_Account_Number__c" aura:id="iGeneralReferenceAccNum"  class="slds-hide"  />
                                            <lightning:select aura:id="iGeneralReferenceAccNumSel" name="iGeneralReferenceAccNumSel" label="Select Reference Account Number" required="true" onChange="{!c.iGenRefeAccNumSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.selectedOppAppProducts}" var="option">
                                                    <aura:if isTrue="{!not(empty(option.Account_Number__c))}">
                                                        <option text="{!option.Account_Number__c}" value="{!option.Account_Number__c}" selected="{!v.generalOptionValue}"/>
                                                    </aura:if>
                                                </aura:iteration>
                                            </lightning:select>

                                        </span>
                                    </div>
                                </aura:if>
                                <aura:if isTrue="{!v.generalfacInd == 'New'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:inputField fieldName="Unique_Identifier__c" aura:id="iGeneralUniqueIdentifier"  class="slds-hide"  />
                                            <lightning:select aura:id="iGeneralUniqueIdentifierSel" name="iGeneralUniqueIdentifierSel" required="true" label="Select Unique Identifier" onchange="{!c.iGeneralUniqueIdentifierSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.uniqueIdentifiers}" var="option">
                                                <aura:if isTrue="{!option.Product_Name__c == 'Cheque'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Overdraft'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Bank Guarantee'}">
                                                        <option text="{!'BG-' + option.Temp_Account_Number__c }" value="{!'BG-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                </aura:iteration>
                                            </lightning:select>

                                        </span>
                                    </div>
                                </aura:if>
                            </aura:if>

                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/> <!--onclick="{!c.insertGeneralCession}"-->
                                </span>
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="letterUndertaking" label="Letter of Undertaking">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>Letter of Undertaking</b>

                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add Letter of Undertaking" onclick="{!c.addLetterofUndertaking}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>
                <aura:if isTrue="{!v.showLetterDetails}">
                    <lightning:recordEditForm aura:id="iLetterAppRecord" objectApiName="Security_Offered__c" recordId="{!v.iLetterSecRecId}"  onload="{!c.iLetterAppRecordLoad}"
                    onsubmit="{!c.iLetterAppRecordSubmit}" onsuccess="{!c.iLetterAppRecordSuccess}" onerror="{!c.iLetterAppRecordError}">

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add Letter of Undertaking #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeLetterAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iLetterAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iLetterContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iLetterApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iLetterSecurityType" value="Letter of Undertaking" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Description_of_Letter_of_Undertaking__c" aura:id="iLetterUndertaking"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Code_provider__c" aura:id="iCodeProvider" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <label for="iLetterUndertakingOther" class="slds-form-element__label">Description of Letter of Undertaking-other</label>
                                    <lightning:inputField fieldName="Description_of_Letter_of_Undertaking_oth__c" aura:id="iLetterUndertakingOther" variant="label-hidden" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Nominal_Value__c" aura:id="iLetterNominalVal"  required="true" onchange="{!c.iLetterCalcSecValue}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <label for="iLetterASVPerc" class="slds-form-element__label">Approved Security Value Percentage (ASV%)</label>
                                    <lightning:inputField fieldName="Approved_Security_Value_Percentage_ASV__c" aura:id="iLetterASVPerc" variant="label-hidden" required="true" value="0" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="ASV_approved_by_Credit__c" aura:id="iLetterASVCr"  required="false" onchange="{!c.iLetterCalcSecValue}"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Date_ASV_was_approved_by_Credit__c" aura:id="iLetterDateASVApprovCr" required="{!v.letterMandatory}" />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Approved_security_value__c" aura:id="iLetterApprovedSecValue"  required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Specific_Security__c" aura:id="iLetterSpecificSecurity"  required="true" onchange="{!c.iLetterSpecificSecurityOnChange}"/>
                                </span>
                            </div>
                            <aura:if isTrue="{!v.letterSpecificSec}">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <lightning:inputField fieldName="Securities_Offered_for_Facility__c" aura:id="iLetterSecOfferedForfac"  required="true" onchange="{!c.iLetterSecOfferedForfacOnChange}"/>
                                    </span>
                                </div>

                                <aura:if isTrue="{!v.letterfacInd == 'Existing'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iLetterReferenceAccNumSel" name="select" label="Select Reference Account Number" required="true" onChange="{!c.iLetterReferenceAccNumSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.selectedOppAppProducts}" var="option">
                                                    <aura:if isTrue="{!not(empty(option.Account_Number__c))}">
                                                        <option text="{!option.Account_Number__c}" value="{!option.Account_Number__c}" selected="{!v.security.Reference_Account_Number__c}"/>
                                                    </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Reference_Account_Number__c" aura:id="iLetterReferenceAccNum"  class="slds-hide"  />
                                        </span>
                                    </div>
                                </aura:if>
                                <aura:if isTrue="{!v.letterfacInd == 'New'}">
                                    <div class="slds-col slds-size_1-of-2">
                                        <span>
                                            <lightning:select aura:id="iLetterUniqueIdentifierSel" name="select" label="Select Unique Identifier" required="true" onchange="{!c.iLetterUniqueIdentifierSelOnChange}">
                                                <option value="">choose one...</option>
                                                <aura:iteration items="{!v.uniqueIdentifiers}" var="option">
                                                <aura:if isTrue="{!option.Product_Name__c == 'Cheque'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Overdraft'}">
                                                        <option text="{!'CHQ-' + option.Temp_Account_Number__c }" value="{!'CHQ-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                         <aura:if isTrue="{!option.Product_Name__c == 'Bank Guarantee'}">
                                                        <option text="{!'BG-' + option.Temp_Account_Number__c }" value="{!'BG-' + option.Temp_Account_Number__c}"/>
                                                        </aura:if>
                                                </aura:iteration>
                                            </lightning:select>
                                            <lightning:inputField fieldName="Unique_Identifier__c" aura:id="iLetterUniqueIdentifier"  class="slds-hide"  />
                                        </span>
                                    </div>
                                </aura:if>
                            </aura:if>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/> <!--onclick="{!c.insertLetterofUndertaking}"-->
                                </span>
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>

            <lightning:accordionSection name="exconRuling" label="Excon Ruling">
                <div class="slds-grid slds-wrap slds-gutters_medium">
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <b>Excon Ruling</b>

                        </span>
                        <span>
                            <br/>
                            Add all relevant account details
                            <br/>
                            <lightning:icon iconName="utility:help_center" size="xx-small" variant="error" alternativeText="Help Guide" title="Help"></lightning:icon>
                            <lightning:formattedUrl value="./servlet/servlet.FileDownload?file=015300000000xvU" label="Help text and hyperlink" tooltip="Help text and hyperlink" />
                        </span>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <span>
                            <lightning:button label="Add Excon Ruling" onclick="{!c.addExconRuling}" variant="brand" aura:id=""/>
                        </span>
                    </div>
                </div>
                <aura:if isTrue="{!v.showExconDetails}">
                    <lightning:recordEditForm aura:id="iExconAppRecord" objectApiName="Security_Offered__c" recordId="{!v.iExconSecRecId}"  onload="{!c.iExconAppRecordLoad}"
                    onsubmit="{!c.iExconAppRecordSubmit}" onsuccess="{!c.iExconAppRecordSuccess}" onerror="{!c.iExconAppRecordError}">

                        <div class="slds-grid slds-wrap slds-gutters_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <b> Add Excon Ruling #</b>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>

                                    <lightning:helptext
                                                        content="Remove these Details. (This action is not reversible)"
                                                        />
                                    <lightning:button label="Remove Details" onclick="{!c.closeExconAddScreen}" variant="" aura:id=""/>
                                </span>
                            </div>
                            <lightning:inputField fieldName="Account__c" aura:id="iExconAccountId"  required="{!v.hasMemberId}" value="{!v.AccountId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Contact__c" aura:id="iExconContactId"  required="false" value="{!v.contactId}" class="slds-hide"/>
                            <lightning:inputField fieldName="Application__c" aura:id="iExconApplicationId"  required="true" value="{!v.applicationRecordId}" class="slds-hide"/>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Security_Type__c" aura:id="iExconSecurityType" value="Excon Ruling" required="true" disabled="true"/>
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Excon_Approved_Amount__c" aura:id="iExconApprovedAmt"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Excon_Date_approved__c" aura:id="iExconDateApproved" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Excon_Expiry_Date__c" aura:id="iExconExpDate" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Excon_Lead_Bank__c" aura:id="iExconLeadBank" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Excon_Total_allocated__c" aura:id="iExconTotal" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Excon_Absa_allocated_percentage__c" aura:id="iExconAbsaPerc" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Excon_Absa_allocated_Amount__c" aura:id="iExcomAbsaAmt" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Prime_Account_Number__c" aura:id="iExconPrimeAccNo" required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <span>
                                    <lightning:inputField fieldName="Comments__c" aura:id="iExconComments"  required="true"  />
                                </span>
                            </div>
                            <div class="slds-col slds-size_2-of-2">
                                <span>
                                    <lightning:button label="Save" type="submit" variant="brand" aura:id=""/> <!--onclick="{!c.insertExconRuling}"-->
                                </span>
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </aura:if>
            </lightning:accordionSection>
        </lightning:accordion>
    </div>
</aura:component>