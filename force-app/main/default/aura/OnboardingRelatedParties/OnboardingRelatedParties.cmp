<!--
* Lightning Component for OnboardingRelatedParties
*
* @author Vladimir Panajic
* @version v1.0
* @since 2020-02-14
-->
<aura:component
	access="global"
	controller="OnboardingRelatedPartiesControler"
	implements="lightning:availableForFlowScreens,force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction"
>
	<!--<aura:handler name="init" value="{!this}" action="{!c.doInit}"/>-->
	<aura:handler name="init" value="{!this}" action="{!c.doInit}" />

	<!--Attributes-->
	<aura:attribute name="showModal" type="boolean" default="false" />
	<aura:attribute name="accRecId" type="String" />
	<aura:attribute name="rowId" type="String" />
	<aura:attribute name="partiesList" type="Object" />
	<aura:attribute name="data" type="Object" access="global" />
	<aura:attribute name="columns" type="List" />
	<aura:attribute name="searchValue" type="String" />
	<aura:attribute name="isNotValidSearchValue" type="boolean" default="true" />
	<aura:attribute name="showRemoveRelationshipConfirmation" type="boolean" default="false" />
	<aura:attribute name="selectedRecordObjectApiName" type="String" />
	<aura:attribute name="showAccConRelationshipEdit" type="Boolean" />
	<aura:attribute name="showDeleteRelationshipConfirmation" type="boolean" default="false" />
	<aura:attribute name="showFatcaSection" type="boolean" default="false" />
	<aura:attribute name="ChkUBOField" type="String" /><!--Diksha-6569-Document Management-->
	<aura:attribute name="accountClientType" type="String" /><!--Chandra 08252020  against 4746-->
	<aura:attribute name="roleOptions" type="List" /><!--Chandra 08252020  against 4746-->
	<aura:attribute name="selectedRole" type="List" default="[]" /><!--Chandra 08252020  against 4746-->
	<aura:attribute name="isFromUBOListView" type="boolean" default="false" />
	<aura:attribute name="OppStage" type="String" /><!--W-008562-->

	<aura:attribute name="parentRelationshipId" type="String" />
	<aura:attribute name="showCASAReferenceEntry" type="boolean" default="false" />
	<!--Masechaba to add capture CASA Reference-->
	<aura:attribute name="casaReferenceNumber" type="String" />

	<aura:attribute name="recordIdAccountContactEdited" type="String" />
	<aura:attribute name="recordIdAccountAccountEdited" type="String" />
	<aura:attribute name="showModalRecordEdit" type="boolean" default="false" />
	<aura:attribute name="ChangedSharePercentage" type="Decimal" /><!--Chandra 07152020  against 4945-->
	<aura:attribute name="showCard" type="boolean" default="true" /><!--Chandra 07152020  against 4945-->
	<aura:attribute name="processTyperp" type="String" /><!--Manoj-6067-Lite Onboarding Manual Capture-->
	<aura:attribute name="accIdForAccContactEdit" type="String" />
	<aura:attribute name="personAccount" type="Object" />
	<aura:attribute name="countryOfCitizenShip" type="String[]" />

	<aura:method name="getOnboardingAccountId" action="{!c.doAction}" description="Account Id Parameters">
		<aura:attribute name="accId" type="String" />
		<aura:attribute name="processTypeparam" type="String" />
		<!--Manoj-6067-Lite Onboarding Manual Capture-->
	</aura:method>

	<!--latest Added -->
	<aura:attribute name="experianResponse" type="ExperianBusinessDetailsGet_Resp_IB_v1" />

	<aura:attribute name="addressData" type="Object" />
	<aura:attribute name="addressColumns" type="List" />
	<aura:attribute name="isRefreshPage" type="Boolean" />
	<aura:attribute name="isError" type="Boolean" default="true" />
	<aura:attribute name="isError2" type="Boolean" default="true" />
	<aura:attribute name="showAddressForm" type="Boolean" />
	<aura:attribute name="designation" type="String" />

	<aura:attribute name="designationOptions" type="List" />
	<aura:attribute name="accountContactRelation" type="AccountContactRelation" default="{'sobjectType': 'AccountContactRelation'}" />
	<aura:attribute name="countryValuesArray_NEW" type="Object[]" />

	<!--Added by chandra against W-4746 dated 25/08/2020-->
	<aura:method name="getAccountClientType" action="{!c.setClientType}" description="Set Address Client Type based on Account Client Type">
		<aura:attribute name="clientTypeVal" type="String" />
	</aura:method>

	<aura:attribute name="showSpinner" type="boolean" default="false" />
	<!-- Sandeep Golla against W-007847-->
	<aura:attribute name="individualProspectRecordTypeId" type="String" />
	<aura:Attribute name="isEmployed" type="boolean" default="false" />
	<aura:attribute name="countryValuesArray" type="String[]" />
	<aura:attribute name="primaryEntityId" type="String" />
	<!--Chandra 07142020  against 4945-->
	<aura:attribute name="PrimaryClientType" type="String" />
	<!--Anka 19032020 -->
	<aura:handler event="force:showToast" action="{!c.refreshAll}" />

	<!-- TdB : Participant Related Party for Onboarding -->
	<aura:attribute name="isParticipant" type="String" />
	<aura:attribute type="Boolean" name="showNoTaxReason" default="false" />
	<aura:attribute type="Boolean" name="showCountryForeignTax" default="false" />
	<aura:attribute name="isOperatingRole" type="Boolean" />
	<aura:attribute name="isMandatIndemnityUser" type="Boolean" />
	<aura:attribute name="showTempResidentSection" type="Boolean" />

	<aura:registerEvent name="hideRelatedPartiesEvent" type="c:hideRelatedPartiesEvent" />
	<!--Chandra 07172020  against 4945-->

	<aura:if isTrue="{!v.showSpinner}">
		<div class="slds-spinner_container">
			<lightning:spinner aura:id="spinner" variant="brand" size="medium" />
		</div>
	</aura:if>

	<aura:if isTrue="{!v.showCard}">
		<lightning:card title="Related Parties" iconName="standard:document" class="slds-m-left_small">
			<aura:set attribute="actions">
				<lightning:button variant="brand" label="Add" title="Add" onclick="{!c.showClientFinderModal}" />
				<lightning:button label="Refresh" title="Refresh" onclick="{!c.refreshRecords}" />
				<lightning:button label="Get Related Parties" title="Add" onclick="{!c.openCasaReferenceScreen}" />
				<!-- <lightning:button label="Validate" title="Validate" onclick="{!c.validateRecords}"/> -->
			</aura:set>
			<lightning:datatable
				columns="{! v.columns }"
				data="{! v.data }"
				keyField="id"
				onrowaction="{! c.handleRowAction }"
				hideCheckboxColumn="true"
				minColumnWidth="100"
			/>
		</lightning:card>
	</aura:if>

	<aura:if isTrue="{!v.showRemoveRelationshipConfirmation}">
		<div style="height: 640px">
			<section
				role="dialog"
				tabindex="-1"
				aria-labelledby="modal-heading-01"
				aria-modal="true"
				aria-describedby="modal-content-id-1"
				class="slds-modal slds-fade-in-open"
			>
				<div class="slds-modal__container">
					<header class="slds-modal__header">
						<h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Remove Account Contact Relationship</h2>
					</header>
					<div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
						<p>Are you sure you want to remove this contact's relationship with this account?</p>
					</div>
					<footer class="slds-modal__footer slds-modal__footer_directional">
						<lightning:button variant="brand" label="Cancel" title="Cancel" onclick="{! c.cancelRemoveAction }" />
						<lightning:button variant="brand" label="Remove Relationship" title="Confirm" onclick="{! c.confirmRemoveAction }" />
					</footer>
				</div>
			</section>
			<div class="slds-backdrop slds-backdrop_open"></div>
		</div>
	</aura:if>
	<!--//Newly added by Rajesh for delete functionality-->
	<aura:if isTrue="{!v.showDeleteRelationshipConfirmation}">
		<div style="height: 640px">
			<section
				role="dialog"
				tabindex="-1"
				aria-labelledby="modal-heading-01"
				aria-modal="true"
				aria-describedby="modal-content-id-1"
				class="slds-modal slds-fade-in-open"
			>
				<div class="slds-modal__container">
					<header class="slds-modal__header">
						<h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Delete Account Contact Relationship</h2>
					</header>
					<div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
						<p>Are you sure you want to delete this contact's relationship?</p>
					</div>
					<footer class="slds-modal__footer slds-modal__footer_directional">
						<lightning:button variant="brand" label="Cancel" title="Cancel" onclick="{! c.cancelDeleteAction }" />
						<lightning:button variant="brand" label="Delete" title="Confirm" onclick="{! c.confirmDeleteAction }" />
					</footer>
				</div>
			</section>
			<div class="slds-backdrop slds-backdrop_open"></div>
		</div>
	</aura:if>
	<!-- Related Parties Modal-->
	<aura:if isTrue="{!v.showModal}">
		<section
			role="dialog"
			tabindex="-1"
			aria-labelledby="modal-heading-01"
			aria-modal="true"
			aria-describedby="modal-content-id-1"
			class="slds-modal slds-fade-in-open"
		>
			<div class="slds-modal__container">
				<header class="slds-modal__header">
					<lightning:buttonIcon
						iconName="utility:close"
						onclick="{! c.closeClientFinderModal }"
						alternativeText="close"
						variant="bare-inverse"
						class="slds-modal__close"
					/>
					<h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">New Related Party</h2>
				</header>
				<div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
					<p>
						<!--Chandra Added primaryEntityId parameter against 4945 and clientTypeVal against 4746-->
						<c:ClientFinder
							isCompactView="true"
							showCreateIndividualProspect="false"
							showCreateRelatedParty="true"
							showCreateBusinessProspect="false"
							showCreateBusinessProspectOnboarding="false"
							showProductSelection="true"
							showContactSelection="true"
							showCaseHistory="false"
							showLeadHistory="false"
							showParticipantSelection="false"
							searchValue="{!v.searchValue}"
							isNotValidSearchValue="{!v.isNotValidSearchValue}"
							parentId="{!v.accRecId}"
							primaryEntityId="{!v.accRecId}"
							clientTypeVal="{!v.accountClientType}"
							processTypeP="{!v.processTyperp}"
						/>
					</p>
				</div>
				<!--<footer class="slds-modal__footer">
                    <lightning:button class="slds-float_left"
                                      variant="neutral"
                                      label="Cancel"
                                      title="Cancel"
                                      onclick="{! c.closeClientFinderModal }"/>
                    <lightning:button variant="brand"
                                      label="Submit Request"
                                      title="Submit Request"
                                      onclick="{! c.submitProductTermsRequest}"/>
                </footer>-->
			</div>
		</section>
		<div class="slds-backdrop slds-backdrop_open"></div>
	</aura:if>

	<!--Newly added by Rajesh @15/03/2020 For Editing Related parties START-->
	<aura:if isTrue="{!v.showModalRecordEdit}">
		<section
			role="dialog"
			tabindex="-1"
			aria-labelledby="modal-heading-01"
			aria-modal="true"
			aria-describedby="modal-content-id-1"
			class="slds-modal slds-fade-in-open slds-modal_large"
		>
			<div class="slds-modal__container slds-modal__content_large">
				<header class="slds-modal__header">
					<lightning:buttonIcon
						iconName="utility:close"
						onclick="{! c.handleCancelAccConReln}"
						alternativeText="close"
						variant="bare-inverse"
						class="slds-modal__close"
					/>
					<h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">Edit Relationship</h2>
				</header>
				<aura:if isTrue="{!v.showAccConRelationshipEdit}">
					<div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
						<p>
							<h3 class="slds-section__title">
								<span class="slds-truncate slds-button slds-section__title-action" title="Section Title">Relationship Information</span>
							</h3>
							<lightning:recordEditForm
								onload="{!c.handleLoadAccConRelnRecord}"
								aura:id="accConRelnForm"
								objectApiName="AccountContactRelation"
								recordId="{!v.recordIdAccountContactEdited}"
							>
								<lightning:layout>
									<lightning:layoutItem padding="around-small" size="6">
										<lightning:dualListbox
											name="iRoles"
											label="Roles:"
											aura:id="roles"
											sourceLabel="Available"
											selectedLabel="Selected"
											fieldLevelHelp="Select all applicable Roles"
											options="{!v.roleOptions}"
											value="{!v.selectedRole}"
											onchange="{! c.handleChange }"
										/><!--handleChange added by chandra dated 23/07/2020-->
									</lightning:layoutItem>
								</lightning:layout>
								<lightning:layoutItem padding="around-small" size="6">
									<lightning:inputField aura:id="accountId" class="slds-hide" fieldName="AccountId" />
									<lightning:inputField aura:id="contactId" class="slds-hide" fieldName="ContactId" />

									<aura:if isTrue="{!v.processTyperp != 'Surety Onboarding'}">
										<lightning:inputField
											aura:id="sharePercentage"
											fieldName="Share_Percentage__c"
											onchange="{!c.handleSharePercentChange}"
										/>
										<lightning:inputField aura:id="uboFld" class="slds-hide" disabled="true" fieldName="UBO__c" />
										<!--Add slds-hide to removed this field from screen by chandra-->
									</aura:if>

									<aura:if isTrue="{!v.processTyperp != 'Lite Onboarding'}">
										<!--Manoj-6073-Lite Onboarding Manual Capture Individual-->
										<lightning:inputField aura:id="designation" class="slds-hide" value="{!v.designation}" fieldName="Designation__c" />
									</aura:if>

									<aura:if isTrue="{!v.processTyperp != 'Surety Onboarding'}">
										<aura:if isTrue="{!v.processTyperp != 'Lite Onboarding'}">
											<!--Manoj-6073-Lite Onboarding Manual Capture Individual-->
											<!--<aura:if isTrue="{!v.ChkUBOField =='Yes'}">-->
											<lightning:inputField aura:id="taxNumber" fieldName="Tax_Number__c" />
											<!--Diksha-6596- For Documents Management-->
											<lightning:inputField aura:id="taxResidency" fieldName="Tax_Residency__c" />
											<!--Diksha-6596- For Documents Management-->
											<!--</aura:if> -->
										</aura:if>
									</aura:if>
								</lightning:layoutItem>
							</lightning:recordEditForm>

							<!-- TdB: Additional fields for Participant Role -->
							<aura:if isTrue="{!v.isParticipant}">
								<h3 class="slds-section__title">
									<span class="slds-truncate slds-button slds-section__title-action" title="Section Title">Identity and Verification</span>
								</h3>
								<lightning:layout multipleRows="true">
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField
											fieldName="Date_Identified__c"
											aura:id="iDateIdentified"
											value="{!v.personAccount.Date_Identified__c}"
										/>
									</lightning:layoutItem>
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField
											fieldName="Identified_by_Employee_Number__c"
											aura:id="iIdentifiedByEmployeeNumber"
											value="{!v.personAccount.Identified_by_Employee_Number__c}"
										/>
									</lightning:layoutItem>
								</lightning:layout>
							</aura:if>

							<h3 class="slds-section__title">
								<span class="slds-truncate slds-button slds-section__title-action" title="Section Title">Main Details</span>
							</h3>
							<lightning:layout>
								<lightning:layoutItem padding="around-small" size="6">
									<aura:if isTrue="{!v.processTyperp != 'Surety Onboarding'}">
										<aura:if isTrue="{!v.processTyperp != 'Lite Onboarding'}">
											<lightning:input required="true" type="text" name="input1" label="Title" value="{!v.personAccount.PersonTitle}" />
											<lightning:input type="text" name="input1" label="Initials" value="{!v.personAccount.Initials__pc}" />
										</aura:if>
									</aura:if>

									<!--<lightning:input required="true" type="text" name="input1" label="Name" value="{!v.personAccount.Name}" />-->
									<lightning:input type="text" name="input1" label="First Name" value="{!v.personAccount.FirstName}" />
									<lightning:input required="true" type="text" name="input1" label="Last Name" value="{!v.personAccount.LastName}" />
									<lightning:input
										required="true"
										type="text"
										name="input1"
										maxlength="13"
										label="Id Number"
										value="{!v.personAccount.ID_Number__pc}"
									/>
									<!--<lightning:input type="text" name="input1" label="ID Type" value="{!v.personAccount.ID_Type__pc}" required ='true' /> -->
									<lightning:select
										aura:id="clientIdType"
										name="ID Type"
										value="{!v.personAccount.ID_Type__pc}"
										label="ID Type"
										required="true"
									>
										<option value="">--Select--</option>
										<option value="SA Identity Document">SA Identity Document</option>
										<option value="Passport">Passport</option>
										<option value="Temporary ID Document">Temporary ID Document</option>
										<option value="CIF">CIF</option>
									</lightning:select>

									<aura:if isTrue="{!v.processTyperp != 'Surety Onboarding'}">
										<aura:if isTrue="{!v.processTyperp!='Lite Onboarding'}">
											<!--Manoj-6073-Lite Onboarding Manual Capture Individual-->
											<lightning:input
												required="true"
												type="date"
												name="input1"
												label="Birth Date"
												value="{!v.personAccount.PersonBirthdate}"
											/>
										</aura:if>

										<!--  <lightning:input required="true" type="text" name="input1" label="Country of Residence" value="{!v.personAccount.Country_of_Residence__c}" />  -->
										<lightning:select
											required="true"
											name="Country of Residence"
											value="{!v.personAccount.Country_of_Residence__c}"
											label="Country of Residence"
										>
											<option value="">--Select--</option>
											<aura:iteration items="{!v.countryValuesArray_NEW}" var="item">
												<option value="{!item.value}">{!item.label}</option>
											</aura:iteration>
										</lightning:select>

										<aura:if isTrue="{!v.processTyperp!='Lite Onboarding'}">
											<!--Manoj-6073-Lite Onboarding Manual Capture Individual-->
											<lightning:recordEditForm
												recordTypeId="{!v.individualProspectRecordTypeId}"
												objectApiName="Account"
												recordId="{!v.personAccount.Id}"
											>
												<aura:if isTrue="{!v.personAccount.Place_of_Residence__c != 'South African Resident'}">
													<lightning:inputField
														fieldName="Country_Passport_Issued__pc"
														aura:id="iCountryPassportIssued"
														value="{!v.personAccount.Country_Passport_Issued__pc}"
													/>
												</aura:if>
												<lightning:inputField
													fieldName="Date_Issued__pc"
													aura:id="iCountryDateIssued"
													value="{!v.personAccount.Date_Issued__pc}"
												/>
												<lightning:inputField
													fieldName="Communication_Language__pc"
													aura:id="iCommunicationLanguage"
													value="{!v.personAccount.Communication_Language__pc}"
													class="customRequired"
												/>
											</lightning:recordEditForm>
										</aura:if>
									</aura:if>
								</lightning:layoutItem>
								<lightning:layoutItem padding="around-small" size="6">
									<!--   <lightning:input type="text" name="input1" label="Client Creation Reason" value="{!v.personAccount.Client_Creation_Reason__c}" /> -->
									<!--<lightning:input type="text" name="input1" label="Country of Citizenship" value="{!v.personAccount.Country_of_Citizenship__c}" />
                                    <lightning:input type="text" name="input1" label="Country of Birth" value="{!v.personAccount.Country_of_Birth__pc}" />-->
									<aura:if isTrue="{!v.processTyperp != 'Surety Onboarding'}">
										<lightning:dualListbox
											aura:id="selectGenre"
											name="Country of Citizenship"
											required="true"
											label="Country of Citizenship"
											sourceLabel="Available Country"
											selectedLabel="Selected Country"
											options="{!v.countryValuesArray_NEW }"
											value="{!v.countryOfCitizenShip}"
											onchange="{! c.handleChangeCountryOfCitzn }"
										/>
										<!--<lightning:select required="true" name="Country of Citizenship" value="{!v.personAccount.Country_of_Citizenship__c}" label="Country of Citizenship" >
                                    <option value="">Select</option>
                                    <aura:iteration items="{!v.countryValuesArray_NEW}" var="item">
                                        <option value="{!item.value}">{!item.label}</option>
                                    </aura:iteration>
                                </lightning:select>-->

										<lightning:select
											required="true"
											name="Country of Citizenship"
											value="{!v.personAccount.Country_of_Birth__pc}"
											label="Country of Birth"
										>
											<option value="">--Select--</option>
											<aura:iteration items="{!v.countryValuesArray_NEW}" var="item">
												<option value="{!item.value}">{!item.label}</option>
											</aura:iteration>
										</lightning:select>
									</aura:if>
									<aura:if isTrue="{!v.processTyperp != 'Surety Onboarding'}">
										<!--<aura:if isTrue="{!v.processTyperp=='Lite Onboarding'}"
                                        <lightning:inputField fieldName="Client_Type__pc" aura:id="iclientType" value="{!v.personAccount.Client_Type__pc}"/>
                                        <lightning:inputField fieldName="Marital_Status__pc" aura:id="iMaritalStatus"  value="{!v.personAccount.Marital_Status__pc}" />
                                        <lightning:inputField fieldName="Marital_Contract_Type__pc" aura:id="iMaritalContractType"  value="{!v.personAccount.Marital_Contract_Type__pc}" />
                                    </aura:if> -->
									</aura:if>

									<aura:if isTrue="{!v.processTyperp != 'Surety Onboarding'}">
										<aura:if isTrue="{!v.processTyperp!='Lite Onboarding'}">
											<!--Manoj-6073-Lite Onboarding Manual Capture Individual-->
											<lightning:select required="true" name="select1" value="{!v.personAccount.Gender__pc}" label="Gender">
												<option value="">--Select--</option>
												<option value="Male">Male</option>
												<option value="Female">Female</option>
											</lightning:select>
										</aura:if>
									</aura:if>

									<aura:if isTrue="{!v.processTyperp != 'Lite Onboarding'}">
										<lightning:input required="true" type="text" name="input1" label="Email" value="{!v.personAccount.PersonEmail}" />
										<lightning:input required="true" type="text" name="input1" label="Phone" value="{!v.personAccount.Phone}" />
										<lightning:select aura:id="selectedDesignationId" label="Designation" name="Designation" value="{!v.designation}">
											<option value="" text="- NONE -" />
											<aura:iteration items="{!v.designationOptions}" var="designation">
												<option value="{!designation}">{!designation}</option>
											</aura:iteration>
										</lightning:select>
									</aura:if>
								</lightning:layoutItem>
							</lightning:layout>

							<aura:if isTrue="{!v.personAccount.Place_of_Residence__c != 'South African Resident'}">
								<lightning:layout>
									<lightning:layoutItem padding="around-small" size="6">
										<lightning:input
											type="checkbox"
											checked="{!v.personAccount.Is_the_Client_a_Temporary_Resident__c}"
											label="Temporary Resident"
											aura:id="tempResidentId"
											onchange="{!c.handleTempResidentSection}"
										/>
									</lightning:layoutItem>
								</lightning:layout>
							</aura:if>

							<aura:if isTrue="{!v.showTempResidentSection}">
								<lightning:layout>
									<lightning:layoutItem padding="around-small" size="6">
										<lightning:inputField
											fieldName="Country_of_Permanent_Residency__c"
											value="{!v.personAccount.Country_of_Permanent_Residency__c}"
											class="customRequired"
										/>
										<lightning:inputField
											fieldName="Purpose_of_Visit__c"
											value="{!v.personAccount.Purpose_of_Visit__c}"
											class="customRequired"
										/>
										<lightning:inputField
											fieldName="Date_of_Arrival_in_South_Africa__c"
											value="{!v.personAccount.Date_of_Arrival_in_South_Africa__c}"
											class="customRequired"
										/>
									</lightning:layoutItem>
									<lightning:layoutItem padding="around-small" size="6">
										<lightning:inputField
											fieldName="Period_of_Visit__c"
											value="{!v.personAccount.Period_of_Visit__c}"
											class="customRequired"
										/>
										<lightning:inputField
											fieldName="Temporary_Resident_Permit__c"
											value="{!v.personAccount.Temporary_Resident_Permit__c}"
										/>
										<lightning:inputField
											fieldName="Temporary_Resident_Permit_Expiry_Date__c"
											value="{!v.personAccount.Temporary_Resident_Permit_Expiry_Date__c}"
										/>
									</lightning:layoutItem>
								</lightning:layout>
							</aura:if>

							<!-- TdB: Additional fields for Participant Role -->
							<aura:if isTrue="{!v.isParticipant}">
								<lightning:layout multipleRows="true">
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField
											fieldName="Primary_Identification_Reason__c"
											value="{!v.personAccount.Primary_Identification_Reason__c}"
										/>
									</lightning:layoutItem>
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField fieldName="Place_of_Birth_City_Town__c" value="{!v.personAccount.Place_of_Birth_City_Town__c}" />
									</lightning:layoutItem>
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField fieldName="Passport_Number__pc" value="{!v.personAccount.Passport_Number__pc}" />
									</lightning:layoutItem>
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField fieldName="Passport_Expiry_Date__c" value="{!v.personAccount.Passport_Expiry_Date__c}" />
									</lightning:layoutItem>
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField
											fieldName="Temporary_resident_permit_number__c"
											value="{!v.personAccount.Temporary_resident_permit_number__c}"
										/>
									</lightning:layoutItem>
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField
											fieldName="Temporary_Resident_Permit_Expiry_Date__c"
											value="{!v.personAccount.Temporary_Resident_Permit_Expiry_Date__c}"
										/>
									</lightning:layoutItem>
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField fieldName="City_of_Residence__c" value="{!v.personAccount.City_of_Residence__c}" />
									</lightning:layoutItem>
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField fieldName="Nationality__pc" value="{!v.personAccount.Nationality__pc}" />
									</lightning:layoutItem>
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField fieldName="Practice_Number__c" value="{!v.personAccount.Practice_Number__c}" />
									</lightning:layoutItem>
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField fieldName="Group_Scheme_Code__c" value="{!v.personAccount.Group_Scheme_Code__c}" />
									</lightning:layoutItem>
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField fieldName="Employee_No__c" value="{!v.personAccount.Employee_No__c}" />
									</lightning:layoutItem>
								</lightning:layout>
							</aura:if>

							<aura:if isTrue="{!v.processTyperp != 'Surety Onboarding'}">
								<aura:if isTrue="{!v.processTyperp!='Lite Onboarding'}">
									<!--Manoj-6073-Lite Onboarding Manual Capture Individual-->

									<aura:if isTrue="{!v.isOperatingRole}">
										<!-- TdB - Occupation START-->
										<h3 class="slds-section__title">
											<span class="slds-truncate slds-button slds-section__title-action" title="Section Title">Occupation Details</span>
										</h3>

										<lightning:layout multipleRows="true">
											<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
												<lightning:inputField
													aura:id="iOccupationStatus"
													fieldName="Occupation_Status__pc"
													onchange="{!c.setOccupationFields}"
													value="{!v.personAccount.Occupation_Status__pc}"
													required="true"
												/>
											</lightning:layoutItem>
											<!--<aura:if isTrue="{!v.isEmployed}">-->
											<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
												<lightning:inputField fieldName="Occupation__pc" value="{!v.personAccount.Occupation__pc}" />
											</lightning:layoutItem>
											<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
												<lightning:inputField fieldName="Occupation_Category__pc" value="{!v.personAccount.Occupation_Category__pc}" />
											</lightning:layoutItem>
											<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
												<lightning:inputField fieldName="Occupation_Level__pc" value="{!v.personAccount.Occupation_Level__pc}" />
											</lightning:layoutItem>
											<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
												<lightning:inputField fieldName="Employer_Name__pc" value="{!v.personAccount.Employer_Name__pc}" />
											</lightning:layoutItem>
											<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
												<lightning:inputField fieldName="Employer_Sector__pc" value="{!v.personAccount.Employer_Sector__pc}" />
											</lightning:layoutItem>
											<!-- </aura:if>-->
										</lightning:layout>
										<br />
									</aura:if>
								</aura:if>
								<!--Occupation End-->

								<h3 class="slds-section__title">
									<span class="slds-truncate slds-button slds-section__title-action" title="Section Title">Address Details</span>
								</h3>
								<br />

								<!--BUSINESS ADDRESS START-->
								<c:OnboardingClientBusAdd isFromEditRelatedParty="true" aura:id="addressComp" />
								<!--BUSINESS ADDRESS END-->

								<h3 class="slds-section__title">
									<span class="slds-truncate slds-button slds-section__title-action" title="Section Title">Company Involvement</span>
								</h3>
								<lightning:layout>
									<lightning:layoutItem padding="around-small" size="12">
										<div style="display: none">
											<!--Newly commented by Rajesh for Popup issue-->
											<!--<lightning:inputField fieldName="BillingAddress"/>-->
										</div>
										<lightning:recordEditForm objectApiName="Account">
											<lightning:inputField fieldName="US_Person__c" value="{!v.personAccount.US_Person__c}" />
											<lightning:inputField
												required="{!v.isOperatingRole}"
												fieldName="Operating_Roles__c"
												value="{!v.personAccount.Operating_Roles__c}"
												aura:id="operatingRoleId"
												onchange="{!c.handleChangeOperatingRole}"
											/>
											<aura:if isTrue="{!v.isMandatIndemnityUser}">
												<lightning:inputField fieldName="Type_of_Instruction__c" value="{!v.personAccount.Type_of_Instruction__c}" />
												<lightning:inputField fieldName="Account_Applicable__c" value="{!v.personAccount.Account_Applicable__c}" />
												<lightning:inputField fieldName="Instruction_Method__c" value="{!v.personAccount.Instruction_Method__c}" />
											</aura:if>
										</lightning:recordEditForm>
									</lightning:layoutItem>
								</lightning:layout>
							</aura:if>

							<!-- TdB: Additional fields for Participant Role -->
							<aura:if isTrue="{!v.isParticipant}">
								<h3 class="slds-section__title">
									<span class="slds-truncate slds-button slds-section__title-action" title="Section Title">Financial Information</span>
								</h3>
								<lightning:layout multipleRows="true">
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<label for="prevInsolvent" class="slds-form-element__label">Have you ever been insolvent or under debt review?</label>
									</lightning:layoutItem>

									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField
											fieldName="Insolvent_Debit_Review__pc"
											aura:id="prevInsolvent"
											variant="label-hidden"
											value="{!v.personAccount.Insolvent_Debit_Review__pc}"
										/>
										<div aura:id="errPrevInsolvent" class="slds-hide" style="color: var(--lwc-colorTextError, rgb(194, 57, 52)) !important">
											Please Select a Value
										</div>
									</lightning:layoutItem>

									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:input
											type="checkbox"
											name="registeredTax"
											aura:id="registeredTax"
											label="Registered for TAX in South Africa"
											checked="true"
											onchange="{! c.showReasonForTaxNA }"
										/>
									</lightning:layoutItem>

									<aura:if isTrue="{!v.showNoTaxReason}">
										<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
											<lightning:inputField
												fieldName="Reason_For_Not_Providing_SA_Tax_Number__c"
												aura:id="reasonForTaxNA"
												value="{!v.personAccount.Reason_For_Not_Providing_SA_Tax_Number__c}"
											/>
											<div
												aura:id="errreasonForTaxNA"
												class="slds-hide"
												style="color: var(--lwc-colorTextError, rgb(194, 57, 52)) !important"
											>
												Please Enter Reason For Not Providing SA Tax Number
											</div>
										</lightning:layoutItem>
										<aura:set attribute="else">
											<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
												<lightning:inputField
													fieldName="Income_Tax_Number__c"
													aura:id="itNumber"
													value="{!v.personAccount.Income_Tax_Number__c}"
												/>
												<div
													aura:id="erritNumber"
													class="slds-hide"
													style="color: var(--lwc-colorTextError, rgb(194, 57, 52)) !important"
												>
													Complete this field
												</div>
											</lightning:layoutItem>
										</aura:set>
									</aura:if>

									<lightning:layout>
										<lightning:layoutItem>
											<lightning:inputField
												fieldName="FAIS_Act__c"
												aura:id="faisAct"
												variant="label-hidden"
												onchange="{!c.handleCheckboxChange}"
												value="{!v.personAccount.FAIS_Act__c}"
											/>
										</lightning:layoutItem>

										<lightning:layoutItem>
											<label for="faisAct" class="slds-form-element__label"
												>Client Renders Financial Services as defined in the FAIS Act</label
											>
										</lightning:layoutItem>
									</lightning:layout>

									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:input
											type="checkbox"
											name="registeredForeignTax"
											aura:id="registeredForeignTax"
											label="Registered for Foreign TAX"
										/>
									</lightning:layoutItem>

									<aura:if isTrue="{!v.showCountryForeignTax}">
										<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
											<lightning:inputField
												fieldName="Country_of_Foreign_tax__c"
												aura:id="countryForeignTax"
												value="{!v.personAccount.Country_of_Foreign_tax__c}"
											/>
											<div
												aura:id="errCountryForeignTax"
												class="slds-hide"
												style="color: var(--lwc-colorTextError, rgb(194, 57, 52)) !important"
											>
												Please select the country registered for foreign tax
											</div>
										</lightning:layoutItem>

										<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6"> </lightning:layoutItem>

										<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
											<lightning:inputField
												fieldName="Foreign_Tax_Number__c"
												aura:id="foreignTax"
												value="{!v.personAccount.Foreign_Tax_Number__c}"
											/>
											<div
												aura:id="errforeignTaxNumber"
												class="slds-hide"
												style="color: var(--lwc-colorTextError, rgb(194, 57, 52)) !important"
											>
												Complete this field
											</div>
										</lightning:layoutItem>

										<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6"> </lightning:layoutItem>
									</aura:if>
									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField
											fieldName="Monthly_Income__pc"
											aura:id="iMonthlyIncome"
											value="{!v.personAccount.Monthly_Income__pc}"
										/>
										<div aura:id="errMonthlyIncome" class="slds-hide" style="color: var(--lwc-colorTextError, rgb(194, 57, 52)) !important">
											Please Enter Monthly Income
										</div>
									</lightning:layoutItem>

									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField
											fieldName="Does_the_Client_fall_under_the_CPA__c"
											value="{!v.personAccount.Does_the_Client_fall_under_the_CPA__c}"
										/>
									</lightning:layoutItem>

									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField
											fieldName="Does_the_Client_fall_under_the_CPA__c"
											value="{!v.personAccount.Does_the_Client_fall_under_the_CPA__c}"
										/>
									</lightning:layoutItem>

									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField fieldName="Is_Customer_Multi_Banked__c" value="{!v.personAccount.Is_Customer_Multi_Banked__c}" />
									</lightning:layoutItem>

									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField
											fieldName="Customer_Accounts_closed_by_another_Bank__c"
											value="{!v.personAccount.Customer_Accounts_closed_by_another_Bank__c}"
										/>
									</lightning:layoutItem>

									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6" class="slds-hide">
										<lightning:inputField
											fieldName="Client_Group__c"
											aura:id="iClientGroupRelatdeParty"
											value="{!v.personAccount.Client_Group__c}"
										/>
									</lightning:layoutItem>

									<lightning:layoutItem padding="" size="6" smallDeviceSize="12" mediumDeviceSize="6">
										<lightning:inputField
											fieldName="Source_of_Income__c"
											aura:id="iSourceOfIncome"
											value="{!v.personAccount.Source_of_Income__c}"
										/>
									</lightning:layoutItem>
								</lightning:layout>

								<h3 class="slds-section__title">
									<span class="slds-truncate slds-button slds-section__title-action" title="Section Title">Regulatory Section - 3(i)f</span>
								</h3>
								<lightning:layout>
									<lightning:layoutItem>
										<lightning:inputField
											fieldName="Is_the_Client_a_Temporary_Resident__c"
											variant="label-hidden"
											aura:id="iTemporaryResident"
											value="{!v.personAccount.Is_the_Client_a_Temporary_Resident__c}"
										/>
									</lightning:layoutItem>
									<lightning:layoutItem>
										<label for="iTemporaryResident" class="slds-form-element__label">Is the Client a Temporary Resident?</label>
									</lightning:layoutItem> </lightning:layout
								><br />
								<lightning:layout>
									<lightning:layoutItem>
										<lightning:inputField
											fieldName="Is_the_Client_a_Non_resident__c"
											variant="label-hidden"
											aura:id="iNonResident"
											value="{!v.personAccount.Is_the_Client_a_Non_resident__c}"
										/>
									</lightning:layoutItem>
									<lightning:layoutItem>
										<label for="iNonResident" class="slds-form-element__label">Is the Client a Non-resident?</label>
									</lightning:layoutItem> </lightning:layout
								><br />
							</aura:if>
						</p>
					</div>
					<footer class="slds-modal__footer">
						<lightning:button variant="neutral" label="Cancel" title="Cancel" onclick="{! c.handleCancelAccConReln }" />

						<lightning:button variant="brand" label="Save" title="Save" onclick="{! c.handleUpdateAccConRelationship }" />
					</footer>
					<aura:set attribute="else">
						<div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
							<lightning:recordForm
								aura:id="myRecordForm"
								recordId="{!v.recordIdAccountAccountEdited}"
								objectApiName="{!v.selectedRecordObjectApiName}"
								layoutType="Full"
								columns="2"
								mode="edit"
								onsubmit="{!c.updateAccAccRecord}"
							/>
						</div>
					</aura:set>
				</aura:if>
			</div>
		</section>

		<div class="slds-backdrop slds-backdrop_open"></div>
	</aura:if>
	<!--Newly added by Rajesh @15/03/2020 For Editing AccountContactRelationship END-->

	<!-- Add CASA Reference Modal-->
	<aura:if isTrue="{!v.showCASAReferenceEntry}">
		<section
			role="dialog"
			tabindex="-1"
			aria-labelledby="modal-heading-01"
			aria-modal="true"
			aria-describedby="modal-content-id-1"
			class="slds-modal slds-fade-in-open slds-modal_large"
		>
			<div class="slds-modal__container slds-modal__content_large" style="width: 70%; !important">
				<header class="slds-modal__header">
					<lightning:buttonIcon
						iconName="utility:close"
						onclick="{! c.closeCasaReferenceScreen}"
						alternativeText="close"
						variant="bare-inverse"
						class="slds-modal__close"
					/>
					<h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">CASA Reference Input</h2>
				</header>
				<div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1" style="overflow: initial">
					<p>
						<lightning:input aura:id="casaReferenceNumber" name="casaReferenceNumber" label="CASA Reference Number" />
					</p>
				</div>
				<footer class="slds-modal__footer">
					<lightning:button variant="neutral" label="Cancel" title="Cancel" onclick="{! c.closeCasaReferenceScreen}" />
					<lightning:button variant="brand" label="Proceed To Onboarding" title="Save" onclick="{! c.loadRelatedParties}" />
				</footer>
			</div>
		</section>
		<div class="slds-backdrop slds-backdrop_open"></div>
	</aura:if>
</aura:component>